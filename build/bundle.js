var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function i(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t){return null==t?"":t}function a(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function c(t){t.parentNode.removeChild(t)}function l(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function p(){return h(" ")}function d(){return h("")}function y(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function v(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}function b(t,e,n){t.classList[n?"add":"remove"](e)}let w;function $(t){w=t}function _(){if(!w)throw new Error("Function called outside component initialization");return w}function S(t){_().$$.before_update.push(t)}function x(t){_().$$.on_mount.push(t)}function E(t){_().$$.on_destroy.push(t)}function P(){const t=_();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const i=function(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}(e,n);r.slice().forEach((e=>{e.call(t,i)}))}}}const k=[],O=[],I=[],A=[],N=Promise.resolve();let C=!1;function D(t){I.push(t)}let j=!1;const F=new Set;function H(){if(!j){j=!0;do{for(let t=0;t<k.length;t+=1){const e=k[t];$(e),R(e.$$)}for($(null),k.length=0;O.length;)O.pop()();for(let t=0;t<I.length;t+=1){const e=I[t];F.has(e)||(F.add(e),e())}I.length=0}while(k.length);for(;A.length;)A.pop()();C=!1,j=!1,F.clear()}}function R(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(D)}}const U=new Set;let L;function V(){L={r:0,c:[],p:L}}function M(){L.r||r(L.c),L=L.p}function B(t,e){t&&t.i&&(U.delete(t),t.i(e))}function z(t,e,n,r){if(t&&t.o){if(U.has(t))return;U.add(t),L.c.push((()=>{U.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function W(t){t&&t.c()}function K(t,n,o,s){const{fragment:a,on_mount:u,on_destroy:c,after_update:l}=t.$$;a&&a.m(n,o),s||D((()=>{const n=u.map(e).filter(i);c?c.push(...n):r(n),t.$$.on_mount=[]})),l.forEach(D)}function q(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Q(t,e){-1===t.$$.dirty[0]&&(k.push(t),C||(C=!0,N.then(H)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Y(e,i,o,s,a,u,l,f=[-1]){const h=w;$(e);const p=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:i.context||[]),callbacks:n(),dirty:f,skip_bound:!1,root:i.target||h.$$.root};l&&l(p.root);let d=!1;if(p.ctx=o?o(e,i.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return p.ctx&&a(p.ctx[t],p.ctx[t]=i)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](i),d&&Q(e,t)),n})):[],p.update(),d=!0,r(p.before_update),p.fragment=!!s&&s(p.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);p.fragment&&p.fragment.l(t),t.forEach(c)}else p.fragment&&p.fragment.c();i.intro&&B(e.$$.fragment),K(e,i.target,i.anchor,i.customElement),H()}$(h)}class G{$destroy(){q(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}class J{constructor(t){this._value=t}get isFilled(){return 1===this._value}get isAnimated(){return 2===this._value}}class X extends J{constructor(t=!1){super(1),this.isSolid=t}}function Z(e){let n,r;return{c(){n=f("div"),m(n,"class",r=s(tt(e[0]))+" svelte-156na4h")},m(t,r){u(t,n,r),e[2](n)},p(t,[e]){1&e&&r!==(r=s(tt(t[0]))+" svelte-156na4h")&&m(n,"class",r)},i:t,o:t,d(t){t&&c(n),e[2](null)}}}function tt(t){if(t)return t.isFilled?"filled":t.isAnimated?"animated":void 0}function et(t,e,n){let r,{tile:i}=e;return t.$$set=t=>{"tile"in t&&n(0,i=t.tile)},[i,r,function(t){O[t?"unshift":"push"]((()=>{r=t,n(1,r)}))}]}class nt extends G{constructor(t){super(),Y(this,t,et,Z,o,{tile:0})}}function rt(e){let n,r,i,o,s,l,h,d,y,g,v,b,w,$,_,S,x,E,P,k,O,I,T,A,N,C,D,j,F,H,R,U,L,V,M,Q,Y,G,J,X,Z,tt,et,rt,ot,st,at,ut,ct,lt,ft,ht,pt,dt,yt,mt,gt,vt,bt,wt,$t,_t,St,xt,Et,Pt,kt,Ot,It,Tt,At,Nt,Ct,Dt,jt,Ft,Ht,Rt,Ut,Lt,Vt,Mt,Bt,zt,Wt,Kt,qt,Qt,Yt,Gt,Jt,Xt,Zt,te,ee,ne,re,ie,oe,se,ae,ue,ce,le,fe,he,pe,de,ye,me,ge,ve,be,we,$e,_e,Se,xe,Ee,Pe,ke,Oe,Ie,Te,Ae,Ne,Ce,De,je,Fe,He,Re,Ue,Le,Ve,Me,Be,ze,We,Ke,qe,Qe,Ye,Ge,Je,Xe,Ze,tn,en,nn,rn,on,sn,an,un,cn,ln,fn,hn,pn,dn,yn,mn,gn,vn,bn,wn,$n,_n,Sn,xn,En,Pn,kn,On,In,Tn,An,Nn,Cn,Dn,jn,Fn,Hn,Rn,Un,Ln,Vn,Mn,Bn;return l=new nt({props:{tile:e[0]}}),g=new nt({props:{tile:e[0]}}),b=new nt({props:{tile:e[0]}}),E=new nt({props:{tile:e[0]}}),A=new nt({props:{tile:e[0]}}),j=new nt({props:{tile:e[0]}}),H=new nt({props:{tile:e[0]}}),Q=new nt({props:{tile:e[0]}}),X=new nt({props:{tile:e[0]}}),tt=new nt({props:{tile:e[0]}}),rt=new nt({props:{tile:e[0]}}),st=new nt({props:{tile:e[0]}}),lt=new nt({props:{tile:e[0]}}),dt=new nt({props:{tile:e[0]}}),mt=new nt({props:{tile:e[0]}}),wt=new nt({props:{tile:e[0]}}),xt=new nt({props:{tile:e[0]}}),Pt=new nt({props:{tile:e[0]}}),Tt=new nt({props:{tile:e[0]}}),Dt=new nt({props:{tile:e[0]}}),Lt=new nt({props:{tile:e[0]}}),Kt=new nt({props:{tile:e[0]}}),Xt=new nt({props:{tile:e[0]}}),ie=new nt({props:{tile:e[0]}}),ce=new nt({props:{tile:e[0]}}),pe=new nt({props:{tile:e[0]}}),ye=new nt({props:{tile:e[0]}}),be=new nt({props:{tile:e[0]}}),Se=new nt({props:{tile:e[0]}}),ke=new nt({props:{tile:e[0]}}),Ie=new nt({props:{tile:e[0]}}),Ce=new nt({props:{tile:e[0]}}),He=new nt({props:{tile:e[0]}}),Ue=new nt({props:{tile:e[0]}}),Ve=new nt({props:{tile:e[0]}}),Be=new nt({props:{tile:e[0]}}),Ye=new nt({props:{tile:e[0]}}),Ze=new nt({props:{tile:e[0]}}),en=new nt({props:{tile:e[0]}}),un=new nt({props:{tile:e[0]}}),hn=new nt({props:{tile:e[0]}}),dn=new nt({props:{tile:e[0]}}),wn=new nt({props:{tile:e[0]}}),Pn=new nt({props:{tile:e[0]}}),Tn=new nt({props:{tile:e[0]}}),Dn=new nt({props:{tile:e[0]}}),Rn=new nt({props:{tile:e[0]}}),Mn=new nt({props:{tile:e[0]}}),{c(){n=f("div"),n.innerHTML='<span class="l mr-10 w-40 svelte-2e3mym"></span> \n  <span class="l mr-10 svelte-2e3mym"></span> \n  <span class="l mr-10 svelte-2e3mym"></span> \n  <span class="l mr-10 svelte-2e3mym"></span> \n  <span class="l mr-10 svelte-2e3mym"></span> \n  <span class="r ml-10 w-40 svelte-2e3mym"></span> \n  <span class="r ml-10 svelte-2e3mym"></span> \n  <span class="r ml-10 svelte-2e3mym"></span> \n  <span class="r ml-10 svelte-2e3mym"></span> \n  <span class="r ml-10 svelte-2e3mym"></span>',r=p(),i=f("h1"),i.textContent=`${it}`,o=p(),s=f("div"),W(l.$$.fragment),h=p(),d=f("div"),y=p(),W(g.$$.fragment),v=p(),W(b.$$.fragment),w=p(),$=f("div"),_=p(),S=f("em"),x=p(),W(E.$$.fragment),P=p(),k=f("p"),O=p(),I=f("em"),T=p(),W(A.$$.fragment),N=p(),C=f("div"),D=p(),W(j.$$.fragment),F=p(),W(H.$$.fragment),R=p(),U=f("div"),L=p(),V=f("em"),M=p(),W(Q.$$.fragment),Y=p(),G=f("p"),J=p(),W(X.$$.fragment),Z=p(),W(tt.$$.fragment),et=p(),W(rt.$$.fragment),ot=p(),W(st.$$.fragment),at=p(),ut=f("p"),ct=p(),W(lt.$$.fragment),ft=p(),ht=f("div"),pt=p(),W(dt.$$.fragment),yt=p(),W(mt.$$.fragment),gt=p(),vt=f("div"),bt=p(),W(wt.$$.fragment),$t=p(),_t=f("p"),St=p(),W(xt.$$.fragment),Et=p(),W(Pt.$$.fragment),kt=p(),Ot=f("div"),It=p(),W(Tt.$$.fragment),At=p(),Nt=f("div"),Ct=p(),W(Dt.$$.fragment),jt=p(),Ft=f("p"),Ht=p(),Rt=f("em"),Ut=p(),W(Lt.$$.fragment),Vt=p(),Mt=f("div"),Bt=p(),zt=f("em"),Wt=p(),W(Kt.$$.fragment),qt=p(),Qt=f("div"),Yt=p(),Gt=f("em"),Jt=p(),W(Xt.$$.fragment),Zt=p(),te=f("div"),ee=p(),ne=f("em"),re=p(),W(ie.$$.fragment),oe=p(),se=f("div"),ae=f("em"),ue=p(),W(ce.$$.fragment),le=p(),fe=f("div"),he=p(),W(pe.$$.fragment),de=p(),W(ye.$$.fragment),me=p(),ge=f("div"),ve=p(),W(be.$$.fragment),we=p(),$e=f("p"),_e=p(),W(Se.$$.fragment),xe=p(),Ee=f("div"),Pe=p(),W(ke.$$.fragment),Oe=p(),W(Ie.$$.fragment),Te=p(),Ae=f("div"),Ne=p(),W(Ce.$$.fragment),De=p(),je=f("p"),Fe=p(),W(He.$$.fragment),Re=p(),W(Ue.$$.fragment),Le=p(),W(Ve.$$.fragment),Me=p(),W(Be.$$.fragment),ze=p(),We=f("p"),Ke=p(),qe=f("em"),Qe=p(),W(Ye.$$.fragment),Ge=p(),Je=f("div"),Xe=p(),W(Ze.$$.fragment),tn=p(),W(en.$$.fragment),nn=p(),rn=f("div"),on=p(),sn=f("em"),an=p(),W(un.$$.fragment),cn=p(),ln=f("p"),fn=p(),W(hn.$$.fragment),pn=p(),W(dn.$$.fragment),yn=p(),mn=f("div"),gn=p(),vn=f("em"),bn=p(),W(wn.$$.fragment),$n=p(),_n=f("div"),Sn=p(),xn=f("em"),En=p(),W(Pn.$$.fragment),kn=p(),On=f("p"),In=p(),W(Tn.$$.fragment),An=p(),Nn=f("div"),Cn=p(),W(Dn.$$.fragment),jn=p(),Fn=f("div"),Hn=p(),W(Rn.$$.fragment),Un=p(),Ln=f("div"),Vn=p(),W(Mn.$$.fragment),m(n,"class","topBorder svelte-2e3mym"),m(i,"class","svelte-2e3mym"),m(d,"class","clear svelte-2e3mym"),m($,"class","clear svelte-2e3mym"),m(S,"class","svelte-2e3mym"),m(k,"class","svelte-2e3mym"),m(I,"class","svelte-2e3mym"),m(C,"class","clear svelte-2e3mym"),m(U,"class","clear svelte-2e3mym"),m(V,"class","svelte-2e3mym"),m(G,"class","svelte-2e3mym"),m(ut,"class","svelte-2e3mym"),m(ht,"class","clear svelte-2e3mym"),m(vt,"class","clear svelte-2e3mym"),m(_t,"class","svelte-2e3mym"),m(Ot,"class","clear svelte-2e3mym"),m(Nt,"class","clear svelte-2e3mym"),m(Ft,"class","svelte-2e3mym"),m(Rt,"class","svelte-2e3mym"),m(Mt,"class","clear svelte-2e3mym"),m(zt,"class","svelte-2e3mym"),m(Qt,"class","clear svelte-2e3mym"),m(Gt,"class","svelte-2e3mym"),m(te,"class","clear svelte-2e3mym"),m(ne,"class","svelte-2e3mym"),m(s,"class","view svelte-2e3mym"),m(ae,"class","svelte-2e3mym"),m(fe,"class","clear svelte-2e3mym"),m(ge,"class","clear svelte-2e3mym"),m($e,"class","svelte-2e3mym"),m(Ee,"class","clear svelte-2e3mym"),m(Ae,"class","clear svelte-2e3mym"),m(je,"class","svelte-2e3mym"),m(We,"class","svelte-2e3mym"),m(qe,"class","svelte-2e3mym"),m(Je,"class","clear svelte-2e3mym"),m(rn,"class","clear svelte-2e3mym"),m(sn,"class","svelte-2e3mym"),m(ln,"class","svelte-2e3mym"),m(mn,"class","clear svelte-2e3mym"),m(vn,"class","svelte-2e3mym"),m(_n,"class","clear svelte-2e3mym"),m(xn,"class","svelte-2e3mym"),m(On,"class","svelte-2e3mym"),m(Nn,"class","clear svelte-2e3mym"),m(Fn,"class","clear svelte-2e3mym"),m(Ln,"class","clear svelte-2e3mym"),m(se,"class","view l svelte-2e3mym")},m(t,e){u(t,n,e),u(t,r,e),u(t,i,e),u(t,o,e),u(t,s,e),K(l,s,null),a(s,h),a(s,d),a(s,y),K(g,s,null),a(s,v),K(b,s,null),a(s,w),a(s,$),a(s,_),a(s,S),a(s,x),K(E,s,null),a(s,P),a(s,k),a(s,O),a(s,I),a(s,T),K(A,s,null),a(s,N),a(s,C),a(s,D),K(j,s,null),a(s,F),K(H,s,null),a(s,R),a(s,U),a(s,L),a(s,V),a(s,M),K(Q,s,null),a(s,Y),a(s,G),a(s,J),K(X,s,null),a(s,Z),K(tt,s,null),a(s,et),K(rt,s,null),a(s,ot),K(st,s,null),a(s,at),a(s,ut),a(s,ct),K(lt,s,null),a(s,ft),a(s,ht),a(s,pt),K(dt,s,null),a(s,yt),K(mt,s,null),a(s,gt),a(s,vt),a(s,bt),K(wt,s,null),a(s,$t),a(s,_t),a(s,St),K(xt,s,null),a(s,Et),K(Pt,s,null),a(s,kt),a(s,Ot),a(s,It),K(Tt,s,null),a(s,At),a(s,Nt),a(s,Ct),K(Dt,s,null),a(s,jt),a(s,Ft),a(s,Ht),a(s,Rt),a(s,Ut),K(Lt,s,null),a(s,Vt),a(s,Mt),a(s,Bt),a(s,zt),a(s,Wt),K(Kt,s,null),a(s,qt),a(s,Qt),a(s,Yt),a(s,Gt),a(s,Jt),K(Xt,s,null),a(s,Zt),a(s,te),a(s,ee),a(s,ne),a(s,re),K(ie,s,null),u(t,oe,e),u(t,se,e),a(se,ae),a(se,ue),K(ce,se,null),a(se,le),a(se,fe),a(se,he),K(pe,se,null),a(se,de),K(ye,se,null),a(se,me),a(se,ge),a(se,ve),K(be,se,null),a(se,we),a(se,$e),a(se,_e),K(Se,se,null),a(se,xe),a(se,Ee),a(se,Pe),K(ke,se,null),a(se,Oe),K(Ie,se,null),a(se,Te),a(se,Ae),a(se,Ne),K(Ce,se,null),a(se,De),a(se,je),a(se,Fe),K(He,se,null),a(se,Re),K(Ue,se,null),a(se,Le),K(Ve,se,null),a(se,Me),K(Be,se,null),a(se,ze),a(se,We),a(se,Ke),a(se,qe),a(se,Qe),K(Ye,se,null),a(se,Ge),a(se,Je),a(se,Xe),K(Ze,se,null),a(se,tn),K(en,se,null),a(se,nn),a(se,rn),a(se,on),a(se,sn),a(se,an),K(un,se,null),a(se,cn),a(se,ln),a(se,fn),K(hn,se,null),a(se,pn),K(dn,se,null),a(se,yn),a(se,mn),a(se,gn),a(se,vn),a(se,bn),K(wn,se,null),a(se,$n),a(se,_n),a(se,Sn),a(se,xn),a(se,En),K(Pn,se,null),a(se,kn),a(se,On),a(se,In),K(Tn,se,null),a(se,An),a(se,Nn),a(se,Cn),K(Dn,se,null),a(se,jn),a(se,Fn),a(se,Hn),K(Rn,se,null),a(se,Un),a(se,Ln),a(se,Vn),K(Mn,se,null),Bn=!0},p:t,i(t){Bn||(B(l.$$.fragment,t),B(g.$$.fragment,t),B(b.$$.fragment,t),B(E.$$.fragment,t),B(A.$$.fragment,t),B(j.$$.fragment,t),B(H.$$.fragment,t),B(Q.$$.fragment,t),B(X.$$.fragment,t),B(tt.$$.fragment,t),B(rt.$$.fragment,t),B(st.$$.fragment,t),B(lt.$$.fragment,t),B(dt.$$.fragment,t),B(mt.$$.fragment,t),B(wt.$$.fragment,t),B(xt.$$.fragment,t),B(Pt.$$.fragment,t),B(Tt.$$.fragment,t),B(Dt.$$.fragment,t),B(Lt.$$.fragment,t),B(Kt.$$.fragment,t),B(Xt.$$.fragment,t),B(ie.$$.fragment,t),B(ce.$$.fragment,t),B(pe.$$.fragment,t),B(ye.$$.fragment,t),B(be.$$.fragment,t),B(Se.$$.fragment,t),B(ke.$$.fragment,t),B(Ie.$$.fragment,t),B(Ce.$$.fragment,t),B(He.$$.fragment,t),B(Ue.$$.fragment,t),B(Ve.$$.fragment,t),B(Be.$$.fragment,t),B(Ye.$$.fragment,t),B(Ze.$$.fragment,t),B(en.$$.fragment,t),B(un.$$.fragment,t),B(hn.$$.fragment,t),B(dn.$$.fragment,t),B(wn.$$.fragment,t),B(Pn.$$.fragment,t),B(Tn.$$.fragment,t),B(Dn.$$.fragment,t),B(Rn.$$.fragment,t),B(Mn.$$.fragment,t),Bn=!0)},o(t){z(l.$$.fragment,t),z(g.$$.fragment,t),z(b.$$.fragment,t),z(E.$$.fragment,t),z(A.$$.fragment,t),z(j.$$.fragment,t),z(H.$$.fragment,t),z(Q.$$.fragment,t),z(X.$$.fragment,t),z(tt.$$.fragment,t),z(rt.$$.fragment,t),z(st.$$.fragment,t),z(lt.$$.fragment,t),z(dt.$$.fragment,t),z(mt.$$.fragment,t),z(wt.$$.fragment,t),z(xt.$$.fragment,t),z(Pt.$$.fragment,t),z(Tt.$$.fragment,t),z(Dt.$$.fragment,t),z(Lt.$$.fragment,t),z(Kt.$$.fragment,t),z(Xt.$$.fragment,t),z(ie.$$.fragment,t),z(ce.$$.fragment,t),z(pe.$$.fragment,t),z(ye.$$.fragment,t),z(be.$$.fragment,t),z(Se.$$.fragment,t),z(ke.$$.fragment,t),z(Ie.$$.fragment,t),z(Ce.$$.fragment,t),z(He.$$.fragment,t),z(Ue.$$.fragment,t),z(Ve.$$.fragment,t),z(Be.$$.fragment,t),z(Ye.$$.fragment,t),z(Ze.$$.fragment,t),z(en.$$.fragment,t),z(un.$$.fragment,t),z(hn.$$.fragment,t),z(dn.$$.fragment,t),z(wn.$$.fragment,t),z(Pn.$$.fragment,t),z(Tn.$$.fragment,t),z(Dn.$$.fragment,t),z(Rn.$$.fragment,t),z(Mn.$$.fragment,t),Bn=!1},d(t){t&&c(n),t&&c(r),t&&c(i),t&&c(o),t&&c(s),q(l),q(g),q(b),q(E),q(A),q(j),q(H),q(Q),q(X),q(tt),q(rt),q(st),q(lt),q(dt),q(mt),q(wt),q(xt),q(Pt),q(Tt),q(Dt),q(Lt),q(Kt),q(Xt),q(ie),t&&c(oe),t&&c(se),q(ce),q(pe),q(ye),q(be),q(Se),q(ke),q(Ie),q(Ce),q(He),q(Ue),q(Ve),q(Be),q(Ye),q(Ze),q(en),q(un),q(hn),q(dn),q(wn),q(Pn),q(Tn),q(Dn),q(Rn),q(Mn)}}}const it="Svelte Tetris";function ot(t){return[new X]}class st extends G{constructor(t){super(),Y(this,t,ot,rt,o,{})}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var at=function(t,e){return(at=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function ut(t,e){function n(){this.constructor=t}at(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function ct(t){return"function"==typeof t}var lt=!1,ft={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;lt=t},get useDeprecatedSynchronousErrorHandling(){return lt}};function ht(t){setTimeout((function(){throw t}),0)}var pt={closed:!0,next:function(t){},error:function(t){if(ft.useDeprecatedSynchronousErrorHandling)throw t;ht(t)},complete:function(){}},dt=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function yt(t){return null!==t&&"object"==typeof t}var mt=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),gt=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this,r=n._parentOrParents,i=n._ctorUnsubscribe,o=n._unsubscribe,s=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof t)r.remove(this);else if(null!==r)for(var a=0;a<r.length;++a){r[a].remove(this)}if(ct(o)){i&&(this._unsubscribe=void 0);try{o.call(this)}catch(t){e=t instanceof mt?vt(t.errors):[t]}}if(dt(s)){a=-1;for(var u=s.length;++a<u;){var c=s[a];if(yt(c))try{c.unsubscribe()}catch(t){e=e||[],t instanceof mt?e=e.concat(vt(t.errors)):e.push(t)}}}if(e)throw new mt(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var r=n;(n=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof t){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function vt(t){return t.reduce((function(t,e){return t.concat(e instanceof mt?e.errors:e)}),[])}var bt=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),wt=function(t){function e(n,r,i){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=pt;break;case 1:if(!n){o.destination=pt;break}if("object"==typeof n){n instanceof e?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new $t(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new $t(o,n,r,i)}return o}return ut(e,t),e.prototype[bt]=function(){return this},e.create=function(t,n,r){var i=new e(t,n,r);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(gt),$t=function(t){function e(e,n,r,i){var o,s=t.call(this)||this;s._parentSubscriber=e;var a=s;return ct(n)?o=n:n&&(o=n.next,r=n.error,i=n.complete,n!==pt&&(ct((a=Object.create(n)).unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=o,s._error=r,s._complete=i,s}return ut(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;ft.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=ft.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):ht(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;ht(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};ft.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),ft.useDeprecatedSynchronousErrorHandling)throw t;ht(t)}},e.prototype.__tryOrSetError=function(t,e,n){if(!ft.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(e){return ft.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(ht(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(wt);var _t=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function St(t){return t}function xt(t){return 0===t.length?St:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var Et=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r=this.operator,i=function(t,e,n){if(t){if(t instanceof wt)return t;if(t[bt])return t[bt]()}return t||e||n?new wt(t,e,n):new wt(pt)}(t,e,n);if(r?i.add(r.call(i,this.source)):i.add(this.source||ft.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),ft.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){ft.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,n=e.closed,r=e.destination,i=e.isStopped;if(n||i)return!1;t=r&&r instanceof wt?r:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=Pt(e))((function(e,r){var i;i=n.subscribe((function(e){try{t(e)}catch(t){r(t),i&&i.unsubscribe()}}),r,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[_t]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:xt(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=Pt(t))((function(t,n){var r;e.subscribe((function(t){return r=t}),(function(t){return n(t)}),(function(){return t(r)}))}))},t.create=function(e){return new t(e)},t}();function Pt(t){if(t||(t=ft.Promise||Promise),!t)throw new Error("no Promise impl found");return t}var kt=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),Ot=function(t){function e(e,n){var r=t.call(this)||this;return r.subject=e,r.subscriber=n,r.closed=!1,r}return ut(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(gt),It=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return ut(e,t),e}(wt),Tt=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return ut(e,t),e.prototype[bt]=function(){return new It(this)},e.prototype.lift=function(t){var e=new At(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new kt;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new kt;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new kt;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new kt;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new kt;return this.hasError?(t.error(this.thrownError),gt.EMPTY):this.isStopped?(t.complete(),gt.EMPTY):(this.observers.push(t),new Ot(this,t))},e.prototype.asObservable=function(){var t=new Et;return t.source=this,t},e.create=function(t,e){return new At(t,e)},e}(Et),At=function(t){function e(e,n){var r=t.call(this)||this;return r.destination=e,r.source=n,r}return ut(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):gt.EMPTY},e}(Tt),Nt=function(t){function e(e){var n=t.call(this)||this;return n._value=e,n}return ut(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new kt;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(Tt),Ct=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r.pending=!1,r}return ut(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(t){n=!0,r=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),r},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,n){return t.call(this)||this}return ut(e,t),e.prototype.schedule=function(t,e){return this},e}(gt)),Dt=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return ut(e,t),e.prototype.schedule=function(e,n){return void 0===n&&(n=0),n>0?t.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,n){return n>0||this.closed?t.prototype.execute.call(this,e,n):this._execute(e,n)},e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?t.prototype.requestAsyncId.call(this,e,n,r):e.flush(this)},e}(Ct),jt=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=function(){return Date.now()},t}(),Ft=function(t){function e(n,r){void 0===r&&(r=jt.now);var i=t.call(this,n,(function(){return e.delegate&&e.delegate!==i?e.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return ut(e,t),e.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),e.delegate&&e.delegate!==this?e.delegate.schedule(n,r,i):t.prototype.schedule.call(this,n,r,i)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(jt),Ht=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ut(e,t),e}(Ft))(Dt),Rt=new Et((function(t){return t.complete()}));function Ut(t){return t?function(t){return new Et((function(e){return t.schedule((function(){return e.complete()}))}))}(t):Rt}function Lt(t){return t&&"function"==typeof t.schedule}var Vt=function(t){return function(e){for(var n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()}};function Mt(t,e){return new Et((function(n){var r=new gt,i=0;return r.add(e.schedule((function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function Bt(t,e){return e?Mt(t,e):new Et(Vt(t))}function zt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return Lt(n)?(t.pop(),Mt(t,n)):Bt(t)}function Wt(t){var e=t.error;t.subscriber.error(e)}var Kt=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){var t,e;switch(this.kind){case"N":return zt(this.value);case"E":return t=this.error,new Et(e?function(n){return e.schedule(Wt,0,{error:t,subscriber:n})}:function(e){return e.error(t)});case"C":return Ut()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}(),qt=function(t){function e(e,n,r){void 0===r&&(r=0);var i=t.call(this,e)||this;return i.scheduler=n,i.delay=r,i}return ut(e,t),e.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new Qt(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(Kt.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(Kt.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(Kt.createComplete()),this.unsubscribe()},e}(wt),Qt=function(){return function(t,e){this.notification=t,this.destination=e}}(),Yt=function(t){function e(e,n,r){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=t.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=e<1?1:e,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return ut(e,t),e.prototype.nextInfiniteTimeWindow=function(e){if(!this.isStopped){var n=this._events;n.push(e),n.length>this._bufferSize&&n.shift()}t.prototype.next.call(this,e)},e.prototype.nextTimeWindow=function(e){this.isStopped||(this._events.push(new Gt(this._getNow(),e)),this._trimBufferThenGetEvents()),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new kt;if(this.isStopped||this.hasError?e=gt.EMPTY:(this.observers.push(t),e=new Ot(this,t)),i&&t.add(t=new qt(t,i)),n)for(var s=0;s<o&&!t.closed;s++)t.next(r[s]);else for(s=0;s<o&&!t.closed;s++)t.next(r[s].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||Ht).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(t-r[o].time<n);)o++;return i>e&&(o=Math.max(o,i-e)),o>0&&r.splice(0,o),r},e}(Tt),Gt=function(){return function(t,e){this.time=t,this.value=e}}(),Jt=new Ft(Ct);function Xt(){}function Zt(t){return!!t&&(t instanceof Et||"function"==typeof t.lift&&"function"==typeof t.subscribe)}var te=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}();function ee(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new ne(t,e))}}var ne=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new re(t,this.project,this.thisArg))},t}(),re=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return ut(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(wt),ie=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ut(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(wt),oe=function(t){function e(e,n,r){var i=t.call(this)||this;return i.parent=e,i.outerValue=n,i.outerIndex=r,i.index=0,i}return ut(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(wt);function se(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var ae=se(),ue=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function ce(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var le=function(t){if(t&&"function"==typeof t[_t])return r=t,function(t){var e=r[_t]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(ue(t))return Vt(t);if(ce(t))return n=t,function(t){return n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,ht),t};if(t&&"function"==typeof t[ae])return e=t,function(t){for(var n=e[ae]();;){var r=void 0;try{r=n.next()}catch(e){return t.error(e),t}if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t};var e,n,r,i=yt(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function fe(t,e,n,r,i){if(void 0===i&&(i=new oe(t,n,r)),!i.closed)return e instanceof Et?e.subscribe(i):le(e)(i)}var he={};function pe(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=void 0,r=void 0;return Lt(t[t.length-1])&&(r=t.pop()),"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&dt(t[0])&&(t=t[0]),Bt(t,r).lift(new de(n))}var de=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new ye(t,this.resultSelector))},t}(),ye=function(t){function e(e,n){var r=t.call(this,e)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return ut(e,t),e.prototype._next=function(t){this.values.push(he),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var n=0;n<e;n++){var r=t[n];this.add(fe(this,r,void 0,n))}}},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,n){var r=this.values,i=r[n],o=this.toRespond?i===he?--this.toRespond:this.toRespond:0;r[n]=e,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))},e.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(ie);function me(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[_t]}(t))return function(t,e){return new Et((function(n){var r=new gt;return r.add(e.schedule((function(){var i=t[_t]();r.add(i.subscribe({next:function(t){r.add(e.schedule((function(){return n.next(t)})))},error:function(t){r.add(e.schedule((function(){return n.error(t)})))},complete:function(){r.add(e.schedule((function(){return n.complete()})))}}))}))),r}))}(t,e);if(ce(t))return function(t,e){return new Et((function(n){var r=new gt;return r.add(e.schedule((function(){return t.then((function(t){r.add(e.schedule((function(){n.next(t),r.add(e.schedule((function(){return n.complete()})))})))}),(function(t){r.add(e.schedule((function(){return n.error(t)})))}))}))),r}))}(t,e);if(ue(t))return Mt(t,e);if(function(t){return t&&"function"==typeof t[ae]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new Et((function(n){var r,i=new gt;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(e.schedule((function(){r=t[ae](),i.add(e.schedule((function(){if(!n.closed){var t,e;try{var i=r.next();t=i.value,e=i.done}catch(t){return void n.error(t)}e?n.complete():(n.next(t),this.schedule())}})))}))),i}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function ge(t,e){return e?me(t,e):t instanceof Et?t:new Et(le(t))}var ve=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,n}return ut(e,t),e.prototype._next=function(t){this.parent.notifyNext(t)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(wt),be=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ut(e,t),e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(wt);function we(t,e){if(!e.closed){if(t instanceof Et)return t.subscribe(e);var n;try{n=le(t)(e)}catch(t){e.error(t)}return n}}function $e(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?function(r){return r.pipe($e((function(n,r){return ge(t(n,r)).pipe(ee((function(t,i){return e(n,t,r,i)})))}),n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new _e(t,n))})}var _e=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new Se(t,this.project,this.concurrent))},t}(),Se=function(t){function e(e,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=t.call(this,e)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return ut(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new ve(this),n=this.destination;n.add(e);var r=we(t,e);r!==e&&n.add(r)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(be);function xe(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),$e(St,t)}function Ee(){return xe(1)}function Pe(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ee()(zt.apply(void 0,t))}function ke(t){return!dt(t)&&t-parseFloat(t)+1>=0}function Oe(t){var e=t.subscriber,n=t.counter,r=t.period;e.next(n),this.schedule({subscriber:e,counter:n+1,period:r},r)}function Ie(t,e){return function(n){return n.lift(new Te(t,e))}}var Te=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new Ae(t,this.predicate,this.thisArg))},t}(),Ae=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return ut(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(wt);function Ne(t,e,n){void 0===t&&(t=0);var r=-1;return ke(e)?r=Number(e)<1?1:Number(e):Lt(e)&&(n=e),Lt(n)||(n=Jt),new Et((function(e){var i=ke(t)?t:+t-n.now();return n.schedule(Ce,i,{index:0,period:r,subscriber:e})}))}function Ce(t){var e=t.index,n=t.period,r=t.subscriber;if(r.next(e),!r.closed){if(-1===n)return r.complete();t.index=e+1,this.schedule(t,n)}}var De=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new je(t,this.durationSelector))},t}(),je=function(t){function e(e,n){var r=t.call(this,e)||this;return r.durationSelector=n,r.hasValue=!1,r}return ut(e,t),e.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=void 0;try{e=(0,this.durationSelector)(t)}catch(t){return this.destination.error(t)}var n=we(e,new ve(this));!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}},e.prototype.clearThrottle=function(){var t=this,e=t.value,n=t.hasValue,r=t.throttled;r&&(this.remove(r),this.throttled=void 0,r.unsubscribe()),n&&(this.value=void 0,this.hasValue=!1,this.destination.next(e))},e.prototype.notifyNext=function(){this.clearThrottle()},e.prototype.notifyComplete=function(){this.clearThrottle()},e}(be);function Fe(t,e){return void 0===e&&(e=Jt),n=function(){return Ne(t,e)},function(t){return t.lift(new De(n))};var n}var He=function(){function t(t,e){this.dueTime=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new Re(t,this.dueTime,this.scheduler))},t}(),Re=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.dueTime=n,i.scheduler=r,i.debouncedSubscription=null,i.lastValue=null,i.hasValue=!1,i}return ut(e,t),e.prototype._next=function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(Ue,this.dueTime,this))},e.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},e.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var t=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}},e.prototype.clearDebounce=function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)},e}(wt);function Ue(t){t.debouncedNext()}function Le(t,e){void 0===e&&(e=Jt);var n,r=(n=t)instanceof Date&&!isNaN(+n)?+t-e.now():Math.abs(t);return function(t){return t.lift(new Ve(r,e))}}var Ve=function(){function t(t,e){this.delay=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new Me(t,this.delay,this.scheduler))},t}(),Me=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.delay=n,i.scheduler=r,i.queue=[],i.active=!1,i.errored=!1,i}return ut(e,t),e.dispatch=function(t){for(var e=t.source,n=e.queue,r=t.scheduler,i=t.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){var o=Math.max(0,n[0].time-r.now());this.schedule(t,o)}else this.unsubscribe(),e.active=!1},e.prototype._schedule=function(t){this.active=!0,this.destination.add(t.schedule(e.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))},e.prototype.scheduleNotification=function(t){if(!0!==this.errored){var e=this.scheduler,n=new Be(e.now()+this.delay,t);this.queue.push(n),!1===this.active&&this._schedule(e)}},e.prototype._next=function(t){this.scheduleNotification(Kt.createNext(t))},e.prototype._error=function(t){this.errored=!0,this.queue=[],this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.scheduleNotification(Kt.createComplete()),this.unsubscribe()},e}(wt),Be=function(){return function(t,e){this.time=t,this.notification=e}}();function ze(t,e){return function(n){return n.lift(new We(t,e))}}var We=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new Ke(t,this.compare,this.keySelector))},t}(),Ke=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.keySelector=r,i.hasKey=!1,"function"==typeof n&&(i.compare=n),i}return ut(e,t),e.prototype.compare=function(t,e){return t===e},e.prototype._next=function(t){var e;try{var n=this.keySelector;e=n?n(t):t}catch(t){return this.destination.error(t)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;r||(this.key=e,this.destination.next(t))},e}(wt);var qe=function(){function t(t){if(this.total=t,this.total<0)throw new te}return t.prototype.call=function(t,e){return e.subscribe(new Qe(t,this.total))},t}(),Qe=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return ut(e,t),e.prototype._next=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},e}(wt);var Ye=function(){function t(t){this.callback=t}return t.prototype.call=function(t,e){return e.subscribe(new Ge(t,this.callback))},t}(),Ge=function(t){function e(e,n){var r=t.call(this,e)||this;return r.add(new gt(n)),r}return ut(e,t),e}(wt);var Je=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Xe(t))},t}(),Xe=function(t){function e(e){var n=t.call(this,e)||this;return n.hasPrev=!1,n}return ut(e,t),e.prototype._next=function(t){var e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)},e}(wt);var Ze=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new tn(t,this.count,this.source))},t}(),tn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.count=n,i.source=r,i}return ut(e,t),e.prototype.complete=function(){if(!this.isStopped){var e=this.source,n=this.count;if(0===n)return t.prototype.complete.call(this);n>-1&&(this.count=n-1),e.subscribe(this._unsubscribeAndRecycle())}},e}(wt);function en(t){return function(e){return e.lift(new nn(t))}}var nn=function(){function t(t){this.total=t}return t.prototype.call=function(t,e){return e.subscribe(new rn(t,this.total))},t}(),rn=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return ut(e,t),e.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},e}(wt);function on(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return Lt(n)?(t.pop(),function(e){return Pe(t,e,n)}):function(e){return Pe(t,e)}}function sn(t,e){return"function"==typeof e?function(n){return n.pipe(sn((function(n,r){return ge(t(n,r)).pipe(ee((function(t,i){return e(n,t,r,i)})))})))}:function(e){return e.lift(new an(t))}}var an=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new un(t,this.project))},t}(),un=function(t){function e(e,n){var r=t.call(this,e)||this;return r.project=n,r.index=0,r}return ut(e,t),e.prototype._next=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this._innerSub(e)},e.prototype._innerSub=function(t){var e=this.innerSubscription;e&&e.unsubscribe();var n=new ve(this),r=this.destination;r.add(n),this.innerSubscription=we(t,n),this.innerSubscription!==n&&r.add(this.innerSubscription)},e.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=void 0},e.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&t.prototype._complete.call(this)},e.prototype.notifyNext=function(t){this.destination.next(t)},e}(be);function cn(t,e){return void 0===e&&(e=!1),function(n){return n.lift(new ln(t,e))}}var ln=function(){function t(t,e){this.predicate=t,this.inclusive=e}return t.prototype.call=function(t,e){return e.subscribe(new fn(t,this.predicate,this.inclusive))},t}(),fn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.inclusive=r,i.index=0,i}return ut(e,t),e.prototype._next=function(t){var e,n=this.destination;try{e=this.predicate(t,this.index++)}catch(t){return void n.error(t)}this.nextOrComplete(t,e)},e.prototype.nextOrComplete=function(t,e){var n=this.destination;Boolean(e)?n.next(t):(this.inclusive&&n.next(t),n.complete())},e}(wt);function hn(t,e,n){return function(r){return r.lift(new dn(t,e,n))}}var pn,dn=function(){function t(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}return t.prototype.call=function(t,e){return e.subscribe(new yn(t,this.nextOrObserver,this.error,this.complete))},t}(),yn=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o._tapNext=Xt,o._tapError=Xt,o._tapComplete=Xt,o._tapError=r||Xt,o._tapComplete=i||Xt,ct(n)?(o._context=o,o._tapNext=n):n&&(o._context=n,o._tapNext=n.next||Xt,o._tapError=n.error||Xt,o._tapComplete=n.complete||Xt),o}return ut(e,t),e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},e}(wt);!function(t){t[t.Loading=0]="Loading",t[t.Paused=1]="Paused",t[t.Started=2]="Started",t[t.Over=3]="Over"}(pn||(pn={}));const mn="SVELTE_TETRIS";function gn(){const t=parseInt(localStorage.getItem(mn));return Number.isInteger(t)?t:0}class vn extends J{constructor(){super(0),this.isSolid=!1}}class bn{static getStartBoard(t=0){if(0===t)return new Array(this.Width*this.Height).fill(new vn);const e=[];for(let n=0;n<t;n++)n<=2?e.push(...this.getRandomFilledRow(5,8)):n<=6?e.push(...this.getRandomFilledRow(4,9)):e.push(...this.getRandomFilledRow(3,9));for(let n=0,r=20-t;n<r;n++)e.unshift(...this.EmptyRow);return e}static getRandomFilledRow(t,e){const n=parseInt(`${(e-t+1)*Math.random()+t}`,10),r=new Array(n).fill(new X(!0));for(let t=0,e=10-n;t<e;t++){const t=parseInt(""+(r.length+1)*Math.random(),10);r.splice(t,0,new vn)}return r}static get EmptyRow(){return new Array(this.Width).fill(new vn)}static get FullRow(){return new Array(this.Width).fill(new X)}static getSpeedDelay(t){var e;return null!==(e=this.SpeedDelay[t-1])&&void 0!==e?e:this.SpeedDelay[0]}}var wn,$n;bn.Width=10,bn.Height=20,bn.Points=[100,300,700,1500],bn.MaxPoint=999999,bn.SpeedDelay=[700,600,450,320,240,160],function(t){t[t.Deg0=0]="Deg0",t[t.Deg90=1]="Deg90",t[t.Deg180=2]="Deg180",t[t.Deg270=3]="Deg270"}(wn||(wn={})),function(t){t.Dot="Dot",t.O="O",t.I="I",t.T="T",t.L="L",t.J="J",t.Z="Z",t.S="S"}($n||($n={}));class _n{constructor(t,e){this.rotation=wn.Deg0,this.x=t,this.y=e}store(){return this._lastConfig={x:this.x,y:this.y,rotation:this.rotation,shape:this.shape},this._newPiece()}clearStore(){return this._lastConfig=null,this._newPiece()}revert(){if(this._lastConfig){for(const t in this._lastConfig)this._lastConfig.hasOwnProperty(t)&&(this[t]=this._lastConfig[t]);this._lastConfig=null}return this._newPiece()}rotate(){const t=Object.keys(this._shapes),e=t.indexOf(this.rotation.toString()),n=e>=t.length-1;return this.rotation=Number(n?t[0]:t[e+1]),this.shape=this._shapes[this.rotation],this._newPiece()}moveDown(t=1){return this.y=this.y+t,this._newPiece()}moveRight(){return this.x++,this._newPiece()}moveLeft(){return this.x--,this._newPiece()}get positionOnGrid(){const t=[];for(let e=0;e<4;e++)for(let n=0;n<4;n++)if(this.shape[e][n]){const r=(this.y+e)*bn.Width+this.x+n;r>=0&&t.push(r)}return t}get bottomRow(){return this.y+3}get rightCol(){let t=3;for(;t>=0;){for(let e=0;e<=3;e++)if(this.shape[e][t])return this.x+t;t--}}get leftCol(){return this.x}setShapes(t){this._shapes=t,this.shape=t[this.rotation]}_newPiece(){const t=new _n(this.x,this.y);return t.rotation=this.rotation,t.type=this.type,t.next=this.next,t.setShapes(this._shapes),t._lastConfig=this._lastConfig,t}}const Sn=[];Sn[wn.Deg0]=[[0,0,0,0],[0,1,0,0],[1,1,0,0],[1,0,0,0]],Sn[wn.Deg90]=[[0,0,0,0],[0,0,0,0],[1,1,0,0],[0,1,1,0]];class xn extends _n{constructor(t,e){super(t,e),this.type=$n.Z,this.next=[[1,1,0,0],[0,1,1,0]],this.setShapes(Sn)}}const En=[];En[wn.Deg0]=[[0,0,0,0],[0,0,0,0],[0,1,0,0],[1,1,1,0]],En[wn.Deg90]=[[0,0,0,0],[1,0,0,0],[1,1,0,0],[1,0,0,0]],En[wn.Deg180]=[[0,0,0,0],[0,0,0,0],[1,1,1,0],[0,1,0,0]],En[wn.Deg270]=[[0,0,0,0],[0,1,0,0],[1,1,0,0],[0,1,0,0]];class Pn extends _n{constructor(t,e){super(t,e),this.type=$n.T,this.next=[[0,1,0,0],[1,1,1,0]],this.setShapes(En)}}const kn=[];kn[wn.Deg0]=[[0,0,0,0],[1,0,0,0],[1,1,0,0],[0,1,0,0]],kn[wn.Deg90]=[[0,0,0,0],[0,0,0,0],[0,1,1,0],[1,1,0,0]];class On extends _n{constructor(t,e){super(t,e),this.type=$n.S,this.next=[[0,1,1,0],[1,1,0,0]],this.setShapes(kn)}}const In=[];In[wn.Deg0]=[[0,0,0,0],[0,0,0,0],[1,1,0,0],[1,1,0,0]];class Tn extends _n{constructor(t,e){super(t,e),this.type=$n.O,this.next=[[0,1,1,0],[0,1,1,0]],this.setShapes(In)}}const An=[];An[wn.Deg0]=[[0,0,0,0],[1,0,0,0],[1,0,0,0],[1,1,0,0]],An[wn.Deg90]=[[0,0,0,0],[0,0,0,0],[1,1,1,0],[1,0,0,0]],An[wn.Deg180]=[[0,0,0,0],[1,1,0,0],[0,1,0,0],[0,1,0,0]],An[wn.Deg270]=[[0,0,0,0],[0,0,0,0],[0,0,1,0],[1,1,1,0]];class Nn extends _n{constructor(t,e){super(t,e),this.type=$n.L,this.next=[[0,0,1,0],[1,1,1,0]],this.setShapes(An)}}const Cn=[];Cn[wn.Deg0]=[[0,0,0,0],[0,1,0,0],[0,1,0,0],[1,1,0,0]],Cn[wn.Deg90]=[[0,0,0,0],[0,0,0,0],[1,1,1,0],[0,0,1,0]],Cn[wn.Deg180]=[[0,0,0,0],[1,1,0,0],[1,0,0,0],[1,0,0,0]],Cn[wn.Deg270]=[[0,0,0,0],[0,0,0,0],[1,0,0,0],[1,1,1,0]];class Dn extends _n{constructor(t,e){super(t,e),this.type=$n.J,this.next=[[1,0,0,0],[1,1,1,0]],this.setShapes(Cn)}}const jn=[];jn[wn.Deg0]=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,1,1,1]],jn[wn.Deg90]=[[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0]];class Fn extends _n{constructor(t,e){super(t,e),this.type=$n.I,this.next=[[0,0,0,0],[1,1,1,1]],this.setShapes(jn)}}class Hn{constructor(){this._available=[],this._currentBag=[],this._available.push(Fn),this._available.push(Dn),this._available.push(Nn),this._available.push(Tn),this._available.push(On),this._available.push(Pn),this._available.push(xn)}getRandomPiece(t=4,e=-4){0===this._currentBag.length&&this.generateNewBag();return new(this._currentBag.pop())(t,e)}generateNewBag(){this._currentBag=this._available.slice(),this.shuffleArray(this._currentBag)}shuffleArray(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Rn=function(t,e){return(Rn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Un(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Rn(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Ln=function(){return(Ln=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Vn(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function Mn(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function Bn(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function zn(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Wn(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function Kn(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Wn(arguments[e]));return t}var qn={type:null,entityIds:null,skip:!1,payload:null},Qn=!1;function Yn(t,e,n){Gn(t,e,n),Qn=!0}function Gn(t,e,n){!1===Qn&&(qn.type=t,qn.entityIds=e,qn.payload=n)}function Jn(t,e){return function(n,r,i){var o=i.value;return i.value=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return Yn(t,e),o.apply(this,n)},i}}function Xn(t,e){return t.hasOwnProperty(e)}function Zn(t){return Array.isArray(t)}function tr(t){return t.hasOwnProperty("active")}function er(t){return Zn(t)}function nr(t){var e=t.active,n=t.ids,r=t.entities;return er(e)?function(t,e){var n=t.filter((function(t){return e.indexOf(t)>-1}));if(n.length===t.length)return t;return n}(e,n):!1===Xn(r,e)?null:e}function rr(t){return null==t}function ir(t){return rr(t)?[]:Array.isArray(t)?t:[t]}function or(t){return!!Zn(t)&&0===t.length}function sr(t){return"function"==typeof t}function ar(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var ur={resettable:!1,ttl:null,producerFn:void 0};function cr(){return ur}function lr(t){return!1===rr(t)}var fr=new Tt,hr=new Yt(50,5e3),pr=new Tt;var dr="undefined"!=typeof window,yr=!dr,mr=function(){try{return"undefined"!=typeof localStorage}catch(t){return!1}},gr={},vr={};function br(t){return t&&t.charAt(0).toUpperCase()+t.slice(1)}dr&&(window.$$stores=gr,window.$$queries=vr);var wr,$r,_r=[];function Sr(t,e){for(var n,r,i=[],o=t.ids,s=t.entities,a=e.filterBy,u=e.limitTo,c=e.sortBy,l=e.sortByOrder,f=function(t){var e=s[o[t]];if(!a)return i.push(e),"continue";ir(a).every((function(n){return n(e,t)}))&&i.push(e)},h=0;h<o.length;h++)f(h);if(c){var p=sr(c)?c:(n=c,void 0===(r=l)&&(r=wr.ASC),function(t,e){if(!t.hasOwnProperty(n)||!e.hasOwnProperty(n))return 0;var i="string"==typeof t[n]?t[n].toUpperCase():t[n],o="string"==typeof e[n]?e[n].toUpperCase():e[n],s=0;return i>o?s=1:i<o&&(s=-1),r==wr.DESC?-1*s:s});i=i.sort((function(e,n){return p(e,n,t)}))}var d=Math.min(u||i.length,i.length);return d===i.length?i:i.slice(0,d)}!function(t){t.ASC="asc",t.DESC="desc"}(wr||(wr={})),function(t){t.Set="Set",t.Add="Add",t.Update="Update",t.Remove="Remove"}($r||($r={}));function xr(t){return void 0===t}function Er(t){var e,n,r=t.state,i=t.ids;if(rr(i))return function(t){return Ln(Ln({},t),{entities:{},ids:[],active:er(t.active)?[]:null})}(r);var o=r.entities,s={};try{for(var a=zn(r.ids),u=a.next();!u.done;u=a.next()){var c=u.value;!1===i.includes(c)&&(s[c]=o[c])}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}var l=Ln(Ln({},r),{entities:s,ids:r.ids.filter((function(t){return!1===i.includes(t)}))});return tr(r)&&(l.active=nr(l)),l}function Pr(t,e){var n,r,i={};try{for(var o=zn(Object.keys(t)),s=o.next();!s.done;s=o.next()){var a=s.value;i[a]=e(t[a])}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function kr(t){var e,n,r=t.state,i=t.entities,o=t.idKey,s=t.preAddEntity,a=t.isNativePreAdd;if(Zn(i)){var u=function(t,e,n){var r,i,o={entities:{},ids:[]};try{for(var s=zn(t),a=s.next();!a.done;a=s.next()){var u=n(a.value);o.entities[u[e]]=u,o.ids.push(u[e])}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o}(i,o,s);e=u.entities,n=u.ids}else!function(t){return t.entities&&t.ids}(i)?(e=a?i:Pr(i,s),n=Object.keys(e).map((function(t){return isNaN(t)?t:Number(t)}))):(e=a?i.entities:Pr(i.entities,s),n=i.ids);var c=Ln(Ln({},r),{entities:e,ids:n,loading:!1});return tr(r)&&(c.active=nr(c)),c}function Or(t){Object.freeze(t);var e="function"==typeof t,n=Object.prototype.hasOwnProperty;return Object.getOwnPropertyNames(t).forEach((function(r){!n.call(t,r)||e&&("caller"===r||"callee"===r||"arguments"===r)||null===t[r]||"object"!=typeof t[r]&&"function"!=typeof t[r]||Object.isFrozen(t[r])||Or(t[r])})),t}function Ir(t){return null!=t&&""+t!="false"}function Tr(t){return Ir(t)&&"Object"===t.constructor.name}!function(t){function e(e){return t.call(this,e)||this}Un(e,t)}(Error);var Ar=new Tt,Nr=new Nt(!1),Cr={activeTransactions:0,batchTransaction:null};function Dr(){return Cr.activeTransactions>0}function jr(t,e){void 0===e&&(e=void 0),Dr()||(Cr.batchTransaction=new Tt),Cr.activeTransactions++,Nr.next(!0);try{return t.apply(e)}finally{Yn("@Transaction"),0==--Cr.activeTransactions&&(Cr.batchTransaction.next(!0),Cr.batchTransaction.complete(),Nr.next(!1),Ar.next(!0))}}function Fr(){return function(t,e,n){var r=n.value;return n.value=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return jr((function(){return r.apply(t,e)}),this)},n}}var Hr=function(t){function e(e,n){void 0===e&&(e={}),void 0===n&&(n={});var r=t.call(this,Ln(Ln({},{entities:{},ids:[],loading:!0,error:null}),e),n)||this;return r.options=n,r.entityActions=new Tt,r.entityIdChanges=new Tt,r}var n;return Un(e,t),Object.defineProperty(e.prototype,"selectEntityAction$",{get:function(){return this.entityActions.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectEntityIdChanges$",{get:function(){return this.entityIdChanges.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"idKey",{get:function(){return this.config.idKey||this.options.idKey||"id"},enumerable:!1,configurable:!0}),e.prototype.set=function(t,n){var r=this;if(void 0===n&&(n={}),!rr(t)){Gn("Set Entity");var i=this.akitaPreAddEntity===e.prototype.akitaPreAddEntity;this.setHasCache(!0,{restartTTL:!0}),this._setState((function(e){var o=kr({state:e,entities:t,idKey:r.idKey,preAddEntity:r.akitaPreAddEntity,isNativePreAdd:i});return!1===xr(n.activeId)&&(o.active=n.activeId),o})),this.hasInitialUIState()&&this.handleUICreation(),this.entityActions.next({type:$r.Set,ids:this.ids})}},e.prototype.add=function(t,e){void 0===e&&(e={loading:!1});var n=ir(t);if(!or(n)){var r=function(t){var e,n,r=t.state,i=t.entities,o=t.idKey,s=t.options,a=void 0===s?{}:s,u=t.preAddEntity,c={},l=[],f=!1;try{for(var h=zn(i),p=h.next();!p.done;p=h.next()){var d=p.value;if(!1===Xn(r.entities,d[o])){var y=u(d),m=y[o];c[m]=y,a.prepend?l.unshift(m):l.push(m),f=!0}}}catch(t){e={error:t}}finally{try{p&&!p.done&&(n=h.return)&&n.call(h)}finally{if(e)throw e.error}}return f?{newState:Ln(Ln({},r),{entities:Ln(Ln({},r.entities),c),ids:a.prepend?Kn(l,r.ids):Kn(r.ids,l)}),newIds:l}:null}({state:this._value(),preAddEntity:this.akitaPreAddEntity,entities:n,idKey:this.idKey,options:e});r&&(Gn("Add Entity"),r.newState.loading=e.loading,this._setState((function(){return r.newState})),this.hasInitialUIState()&&this.handleUICreation(!0),this.entityActions.next({type:$r.Add,ids:r.newIds}))}},e.prototype.update=function(e,n){var r=this;if(xr(n))t.prototype.update.call(this,e);else{var i,o=[];if(!or(o=sr(e)?this.ids.filter((function(t){return e(r.entities[t])})):rr(e)?this.ids:ir(e)))Gn("Update Entity",o),this._setState((function(t){return function(t){var e,n,r,i=t.state,o=t.ids,s=t.idKey,a=t.newStateOrFn,u=t.preUpdateEntity,c=t.producerFn,l=t.onEntityIdChanges,f={},h=!1;try{for(var p=zn(o),d=p.next();!d.done;d=p.next()){var y=d.value;if(!1!==Xn(i.entities,y)){var m=i.entities[y],g=void 0,v=(g=sr(a)?sr(c)?c(m,a):a(m):a).hasOwnProperty(s)&&g[s]!==m[s],b=void 0;r=y,v&&(h=!0,r=g[s]);var w=Ln(Ln({},m),g);b=Tr(m)?w:Tr(g)?new m.constructor(w):new g.constructor(w),f[r]=u(m,b)}}}catch(t){e={error:t}}finally{try{d&&!d.done&&(n=p.return)&&n.call(p)}finally{if(e)throw e.error}}var $=i.ids,_=i.entities;if(h){var S=Wn(o,1)[0],x=i.entities,E=S;x[E],_=Vn(x,["symbol"==typeof E?E:E+""]),$=i.ids.map((function(t){return t===S?r:t})),l(S,r)}return Ln(Ln({},i),{entities:Ln(Ln({},_),f),ids:$})}({idKey:r.idKey,ids:o,preUpdateEntity:r.akitaPreUpdateEntity,state:t,newStateOrFn:n,producerFn:r._producerFn,onEntityIdChanges:function(t,e){i={oldId:t,newId:e},r.entityIdChanges.next(Ln(Ln({},i),{pending:!0}))}})})),i&&this.entityIdChanges.next(Ln(Ln({},i),{pending:!1})),this.entityActions.next({type:$r.Update,ids:o})}},e.prototype.upsert=function(t,e,n,r){var i=this;void 0===r&&(r={});var o=ir(t),s=function(t){return function(e){return Xn(i.entities,e)===t}},a=sr(n)?r.baseClass:n?n.baseClass:void 0,u=sr(a),c=o.filter(s(!0)),l=o.filter(s(!1)).map((function(t){var r,o="function"==typeof e?e({}):e,s=sr(n)?n(t,o):o,c=Ln(Ln({},s),((r={})[i.idKey]=t,r));return u?new a(c):c}));this.update(c,e),this.add(l),Yn("Upsert Entity")},e.prototype.upsertMany=function(t,e){var n,r;void 0===e&&(e={});var i=[],o=[],s={};try{for(var a=zn(t),u=a.next();!u.done;u=a.next()){var c=u.value,l=this.akitaPreCheckEntity(c),f=l[this.idKey];if(Xn(this.entities,f)){var h=this._value().entities[f],p=Ln(Ln({},this._value().entities[f]),l),d=e.baseClass?new e.baseClass(p):p,y=(m=this.akitaPreUpdateEntity(h,d))[this.idKey];s[y]=m,o.push(y)}else{var m,g=e.baseClass?new e.baseClass(l):l;y=(m=this.akitaPreAddEntity(g))[this.idKey];i.push(y),s[y]=m}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}Yn("Upsert Many"),this._setState((function(t){return Ln(Ln({},t),{ids:i.length?Kn(t.ids,i):t.ids,entities:Ln(Ln({},t.entities),s),loading:!!e.loading})})),o.length&&this.entityActions.next({type:$r.Update,ids:o}),i.length&&this.entityActions.next({type:$r.Add,ids:i}),i.length&&this.hasUIStore()&&this.handleUICreation(!0)},e.prototype.replace=function(t,e){var n,r,i,o=ir(t);if(!or(o)){var s={};try{for(var a=zn(o),u=a.next();!u.done;u=a.next()){var c=u.value;s[c]=Ln(Ln({},e),((i={})[this.idKey]=c,i))}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}Gn("Replace Entity",t),this._setState((function(t){return Ln(Ln({},t),{entities:Ln(Ln({},t.entities),s)})}))}},e.prototype.move=function(t,e){var n=this.ids.slice();n.splice(e<0?n.length+e:e,0,n.splice(t,1)[0]),Gn("Move Entity"),this._setState((function(t){return Ln(Ln({},t),{entities:Ln({},t.entities),ids:n})}))},e.prototype.remove=function(t){var e=this;if(!or(this.ids)){var n=lr(t),r=[];or(r=sr(t)?this.ids.filter((function(n){return t(e.entities[n])})):n?ir(t):this.ids)||(Gn("Remove Entity",r),this._setState((function(t){return Er({state:t,ids:r})})),n||this.setHasCache(!1),this.handleUIRemove(r),this.entityActions.next({type:$r.Remove,ids:r}))}},e.prototype.updateActive=function(t){var e=ir(this.active);Gn("Update Active",e),this.update(e,t)},e.prototype.setActive=function(t){var e=function(t,e,n){var r;if(Zn(t))r=t;else if(ar(t)){if(rr(n))return;t=Object.assign({wrap:!0},t);var i=e.indexOf(n);if(t.prev){var o=0===i;if(o&&!t.wrap)return;r=o?e[e.length-1]:e[i-1]}else if(t.next){var s=e.length===i+1;if(s&&!t.wrap)return;r=s?e[0]:e[i+1]}}else{if(t===n)return;r=t}return r}(t,this.ids,this.active);void 0!==e&&(Gn("Set Active",e),this._setActive(e))},e.prototype.addActive=function(t){var e=this,n=ir(t);or(n)||(n.every((function(t){return e.active.indexOf(t)>-1}))||(Gn("Add Active",t),this._setState((function(t){var e=Array.from(new Set(Kn(t.active,n)));return Ln(Ln({},t),{active:e})}))))},e.prototype.removeActive=function(t){var e=this,n=ir(t);or(n)||n.some((function(t){return e.active.indexOf(t)>-1}))&&(Gn("Remove Active",t),this._setState((function(t){return Ln(Ln({},t),{active:Array.isArray(t.active)?t.active.filter((function(t){return-1===n.indexOf(t)})):null})})))},e.prototype.toggleActive=function(t){var e=this,n=ir(t),r=function(t){return function(n){return e.active.includes(n)===t}},i=n.filter(r(!0)),o=n.filter(r(!1));this.removeActive(i),this.addActive(o),Yn("Toggle Active")},e.prototype.createUIStore=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n={name:"UI/"+this.storeName,idKey:this.idKey};return this.ui=new Rr(t,Ln(Ln({},n),e)),this.ui},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.ui instanceof e&&this.ui.destroy(),this.entityActions.complete()},e.prototype.akitaPreUpdateEntity=function(t,e){return e},e.prototype.akitaPreAddEntity=function(t){return t},e.prototype.akitaPreCheckEntity=function(t){return t},Object.defineProperty(e.prototype,"ids",{get:function(){return this._value().ids},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entities",{get:function(){return this._value().entities},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){return this._value().active},enumerable:!1,configurable:!0}),e.prototype._setActive=function(t){this._setState((function(e){return Ln(Ln({},e),{active:t})}))},e.prototype.handleUICreation=function(t){var e=this;void 0===t&&(t=!1);var n,r=this.ids,i=sr(this.ui._akitaCreateEntityFn),o=function(t){var n,r=e.entities[t],o=i?e.ui._akitaCreateEntityFn(r):e.ui._akitaCreateEntityFn;return Ln(((n={})[e.idKey]=r[e.idKey],n),o)};n=t?this.ids.filter((function(t){return xr(e.ui.entities[t])})).map(o):r.map(o),t?this.ui.add(n):this.ui.set(n)},e.prototype.hasInitialUIState=function(){return this.hasUIStore()&&!1===xr(this.ui._akitaCreateEntityFn)},e.prototype.handleUIRemove=function(t){this.hasUIStore()&&this.ui.remove(t)},e.prototype.hasUIStore=function(){return this.ui instanceof Rr},Mn([Fr(),Bn("design:type",Function),Bn("design:paramtypes",[Object,Object,Object,Object]),Bn("design:returntype",void 0)],e.prototype,"upsert",null),Mn([Fr(),Bn("design:type",Function),Bn("design:paramtypes",["function"==typeof(n="undefined"!=typeof T&&T)?n:Object]),Bn("design:returntype",void 0)],e.prototype,"toggleActive",null),e}(function(){function t(t,e){void 0===e&&(e={}),this.options=e,this.inTransaction=!1,this.cache={active:new Nt(!1),ttl:null},this.onInit(t)}return t.prototype.setLoading=function(t){void 0===t&&(t=!1),t!==this._value().loading&&(Gn("Set Loading"),this._setState((function(e){return Ln(Ln({},e),{loading:t})})))},t.prototype.setHasCache=function(t,e){var n=this;if(void 0===e&&(e={restartTTL:!1}),t!==this.cache.active.value&&this.cache.active.next(t),e.restartTTL){var r=this.getCacheTTL();r&&(null!==this.cache.ttl&&clearTimeout(this.cache.ttl),this.cache.ttl=setTimeout((function(){return n.setHasCache(!1)}),r))}},t.prototype.getValue=function(){return this.storeValue},t.prototype.setError=function(t){t!==this._value().error&&(Gn("Set Error"),this._setState((function(e){return Ln(Ln({},e),{error:t})})))},t.prototype._select=function(t){return this.store.asObservable().pipe(ee((function(e){return t(e.state)})),ze())},t.prototype._value=function(){return this.storeValue},t.prototype._cache=function(){return this.cache.active},Object.defineProperty(t.prototype,"config",{get:function(){return this.constructor.akitaConfig||{}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storeName",{get:function(){return this.config.storeName||this.options.storeName||this.options.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deepFreeze",{get:function(){return this.config.deepFreezeFn||this.options.deepFreezeFn||Or},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cacheConfig",{get:function(){return this.config.cache||this.options.cache},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_producerFn",{get:function(){return this.config.producerFn||this.options.producerFn||ur.producerFn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resettable",{get:function(){return lr(this.config.resettable)?this.config.resettable:this.options.resettable},enumerable:!1,configurable:!0}),t.prototype._setState=function(t,e){var n=this;if(void 0===e&&(e=!0),sr(t)){var r=t(this._value());this.storeValue=this.deepFreeze(r)}else this.storeValue=t;if(!this.store)return this.store=new Nt({state:this.storeValue}),void this.store.subscribe((function(t){var e=t.action;e&&function(t,e){pr.next({storeName:t,action:e})}(n.storeName,e)}));Dr()?this.handleTransaction():this.dispatch(this.storeValue,e)},t.prototype.reset=function(){var t=this;this.isResettable()?(Gn("Reset"),this._setState((function(){return Object.assign({},t._initialState)})),this.setHasCache(!1)):console.warn("You need to enable the reset functionality")},t.prototype.update=function(t){var e;Gn("Update");var n=this._value();e=sr(t)?sr(this._producerFn)?this._producerFn(n,t):t(n):t;var r=this.akitaPreUpdate(n,Ln(Ln({},n),e)),i=Tr(n)?r:new n.constructor(r);this._setState(i)},t.prototype.updateStoreConfig=function(t){this.options=Ln(Ln({},this.options),t)},t.prototype.akitaPreUpdate=function(t,e){return e},t.prototype.ngOnDestroy=function(){this.destroy()},t.prototype.destroy=function(){var t;!!dr&&window.hmrEnabled||this!==gr[this.storeName]||(delete gr[this.storeName],t=this.storeName,fr.next(t),this.setHasCache(!1),this.cache.active.complete(),this.store.complete())},t.prototype.onInit=function(t){var e;gr[this.storeName]=this,this._setState((function(){return t})),e=this.storeName,hr.next(e),this.isResettable()&&(this._initialState=t),function(t,e){t||console.error("@StoreConfig({ name }) is missing in "+e)}(this.storeName,this.constructor.name)},t.prototype.dispatch=function(t,e){void 0===e&&(e=!0);var n=void 0;e&&(n=qn,Qn=!1),this.store.next({state:t,action:n})},t.prototype.watchTransaction=function(){var t=this;(Cr.batchTransaction?Cr.batchTransaction.asObservable():zt(!0)).subscribe((function(){t.inTransaction=!1,t.dispatch(t._value())}))},t.prototype.isResettable=function(){return!1!==this.resettable&&(this.resettable||cr().resettable)},t.prototype.handleTransaction=function(){this.inTransaction||(this.watchTransaction(),this.inTransaction=!0)},t.prototype.getCacheTTL=function(){return this.cacheConfig&&this.cacheConfig.ttl||cr().ttl},t}()),Rr=function(t){function e(e,n){return void 0===e&&(e={}),void 0===n&&(n={}),t.call(this,e,n)||this}return Un(e,t),e.prototype.setInitialEntityState=function(t){this._akitaCreateEntityFn=t},e}(Hr);function Ur(t){return"string"==typeof t}function Lr(t,e){return function(n){var r=n[t];if(!xr(r))return e?Ur(e)?r[e]:e(r):r}}var Vr=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this,e)||this;return r.options=n,r.__store__=e,r}return Un(e,t),e.prototype.selectAll=function(t){var e=this;return void 0===t&&(t={asObject:!1}),this.select((function(t){return t.entities})).pipe(ee((function(){return e.getAll(t)})))},e.prototype.getAll=function(t){return void 0===t&&(t={asObject:!1,filterBy:void 0,limitTo:void 0}),t.asObject?function(t,e){var n={},r=e.filterBy,i=e.limitTo,o=t.ids,s=t.entities;if(!r&&!i)return s;var a=!1===rr(i);if(r&&a)for(var u=0,c=function(t,e){if(u===i)return"break";var a=o[t],c=s[a];ir(r).every((function(e){return e(c,t)}))&&(n[a]=c,u++)},l=0,f=o.length;l<f&&"break"!==c(l);l++);else{var h=Math.min(i||o.length,o.length),p=function(t){var e=o[t],i=s[e];if(!r)return n[e]=i,"continue";ir(r).every((function(e){return e(i,t)}))&&(n[e]=i)};for(l=0;l<h;l++)p(l)}return n}(this.getValue(),t):(function(t,e){t.sortBy=t.sortBy||e&&e.sortBy,t.sortByOrder=t.sortByOrder||e&&e.sortByOrder}(t,this.config||this.options),Sr(this.getValue(),t))},e.prototype.selectMany=function(t,e){return t&&t.length?this.select((function(t){return t.entities})).pipe(ee((function(n){return r=function(t){return Lr(t,e)(n)},t.reduce((function(t,e,n,i){var o=r(e,n,i);return void 0!==o&&t.push(o),t}),[]);var r})),ze((function(t,e){return t===e||!(!Zn(t)||!Zn(e))&&(!(!or(t)||!or(e))||t.length===e.length&&!1===e.some((function(e,n){return t[n]!==e})))}))):zt([])},e.prototype.selectEntity=function(t,e){var n=t;return sr(t)&&(n=function(t,e){var n,r;try{for(var i=zn(Object.keys(e)),o=i.next();!o.done;o=i.next()){var s=o.value;if(!0===t(e[s]))return s}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}(t,this.getValue().entities)),this.select((function(t){return t.entities})).pipe(ee(Lr(n,e)),ze())},e.prototype.getEntity=function(t){return this.getValue().entities[t]},e.prototype.selectActiveId=function(){return this.select((function(t){return t.active}))},e.prototype.getActiveId=function(){return this.getValue().active},e.prototype.selectActive=function(t){var e=this;return Zn(this.getActive())?this.selectActiveId().pipe(sn((function(n){return e.selectMany(n,t)}))):this.selectActiveId().pipe(sn((function(n){return e.selectEntity(n,t)})))},e.prototype.getActive=function(){var t=this,e=this.getActiveId();return Zn(e)?e.map((function(e){return t.getValue().entities[e]})):Ir(e)?this.getEntity(e):void 0},e.prototype.selectCount=function(t){var e=this;return this.select((function(t){return t.entities})).pipe(ee((function(){return e.getCount(t)})))},e.prototype.getCount=function(t){return sr(t)?this.getAll().filter(t).length:this.getValue().ids.length},e.prototype.selectLast=function(t){return this.selectAt((function(t){return t[t.length-1]}),t)},e.prototype.selectFirst=function(t){return this.selectAt((function(t){return t[0]}),t)},e.prototype.selectEntityAction=function(t){if(rr(t))return this.store.selectEntityAction$;var e=Zn(t)?function(t){return t}:function(t){return t.ids},n=ir(t);return this.store.selectEntityAction$.pipe(Ie((function(t){var e=t.type;return n.includes(e)})),ee((function(t){return e(t)})))},e.prototype.hasEntity=function(t){var e=this;return rr(t)?this.getValue().ids.length>0:sr(t)?this.getAll().some(t):Zn(t)?t.every((function(t){return t in e.getValue().entities})):t in this.getValue().entities},e.prototype.hasActive=function(t){var e=this.getValue().active,n=lr(t);return Array.isArray(e)?n?e.includes(t):e.length>0:n?e===t:lr(e)},e.prototype.createUIQuery=function(){this.ui=new Mr(this.__store__.ui)},e.prototype.selectAt=function(t,e){var n=this;return this.select((function(t){return t.ids})).pipe(ee(t),ze(),sn((function(t){return n.selectEntity(t,e)})))},e}(function(){function t(t){this.store=t,this.__store__=t,vr[t.storeName]=this}return t.prototype.select=function(t){var e,n;if(sr(t))e=t;else if(Ur(t))e=function(e){return e[t]};else{if(Array.isArray(t))return this.store._select((function(t){return t})).pipe(ze((n=t,function(t,e){var r=sr(n[0]);return!1===n.some((function(n){return r?n(t)!==n(e):t[n]!==e[n]}))})),ee((function(e){return sr(t[0])?t.map((function(t){return t(e)})):t.reduce((function(t,n){return t[n]=e[n],t}),{})})));e=function(t){return t}}return this.store._select(e)},t.prototype.selectLoading=function(){return this.select((function(t){return t.loading}))},t.prototype.selectError=function(){return this.select((function(t){return t.error}))},t.prototype.getValue=function(){return this.store._value()},t.prototype.selectHasCache=function(){return this.store._cache().asObservable()},t.prototype.getHasCache=function(){return this.store._cache().value},Object.defineProperty(t.prototype,"config",{get:function(){return this.constructor.akitaQueryConfig},enumerable:!1,configurable:!0}),t}()),Mr=function(t){function e(e){return t.call(this,e)||this}return Un(e,t),e}(Vr);function Br(t,e){return new Hr(t,e)}function zr(t,e){return void 0===e&&(e={}),new Vr(t,e)}function Wr(t,e){return 1===e.split(".").length?t:e.split(".").slice(1).join(".").split(".").reduce((function(t,e){return t&&t[e]}),t)}function Kr(t,e,n,r){void 0===r&&(r=!1);var i=e.split(".");if(1===i.length)return Ln(Ln({},t),n);t=Ln({},t);var o=i.length-2;return e.split(".").slice(1).reduce((function(t,e,i){return i!==o?(t[e]=Ln({},t[e]),t&&t[e]):(t[e]=r||Array.isArray(t[e])||!ar(t[e])?n:Ln(Ln({},t[e]),n),t&&t[e])}),t),t}var qr=new Yt(1);function Qr(){return false}function Yr(t){return(e=t)&&sr(e.then)||Zt(t)?ge(t):zt(t);var e}var Gr=function(){function t(t,e){this.query=t,e&&e.resetFn}return t.prototype.getQuery=function(){return this.query},t.prototype.getStore=function(){return this.getQuery().__store__},t.prototype.isEntityBased=function(t){return Ir(t)},t.prototype.selectSource=function(t,e){var n=this;return this.isEntityBased(t)?this.getQuery().selectEntity(t).pipe(Ie((function(t){return null!=t}))):e?this.getQuery().select((function(t){return Wr(t,n.withStoreName(e))})):this.getQuery().select()},t.prototype.getSource=function(t,e){if(this.isEntityBased(t))return this.getQuery().getEntity(t);var n=this.getQuery().getValue();return e?Wr(n,this.withStoreName(e)):n},t.prototype.withStoreName=function(t){return this.storeName+"."+t},Object.defineProperty(t.prototype,"storeName",{get:function(){return this.getStore().storeName},enumerable:!1,configurable:!0}),t.prototype.updateStore=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),this.isEntityBased(e)){var o=this.getStore();r?o.replace(e,t):o.update(e,t)}else{if(n)return void this.getStore()._setState((function(e){return Kr(e,i.withStoreName(n),t,!0)}));var s=r?t:function(e){return Ln(Ln({},e),t)};this.getStore()._setState(s)}},t.prototype.onReset=function(t){var e=this,n=this.getStore().reset;this.getStore().reset=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];setTimeout((function(){n.apply(e.getStore(),r),t()}))}},t}(),Jr={comparator:function(t,e){return JSON.stringify(t)!==JSON.stringify(e)}};function Xr(t,e){return e.split(".").reduce((function(t,e){return t&&"undefined"!==t[e]?t[e]:void 0}),t)}var Zr=function(t){function e(e,n,r){var i=t.call(this,e)||this;if(i.query=e,i.params=n,i._entityId=r,i.dirty=new Nt(!1),i.active=!1,i._reset=new Tt,i.isDirty$=i.dirty.asObservable().pipe(ze()),i.reset$=i._reset.asObservable(),i.params=Ln(Ln({},Jr),n),i.params.watchProperty){var o=ir(i.params.watchProperty);e instanceof Vr&&o.includes("entities")&&!o.includes("ids")&&o.push("ids"),i.params.watchProperty=o}return i}return Un(e,t),e.prototype.reset=function(t){void 0===t&&(t={});var e=this.head;sr(t.updateFn)&&(e=this.isEntityBased(this._entityId)?t.updateFn(this.head,this.getQuery().getEntity(this._entityId)):t.updateFn(this.head,this.getQuery().getValue())),Yn("@DirtyCheck - Revert"),this.updateStore(e,this._entityId),this._reset.next()},e.prototype.setHead=function(){return this.active?this.head=this._getHead():(this.activate(),this.active=!0),this.updateDirtiness(!1),this},e.prototype.isDirty=function(){return!!this.dirty.value},e.prototype.hasHead=function(){return!!this.getHead()},e.prototype.destroy=function(){this.head=null,this.subscription&&this.subscription.unsubscribe(),this._reset&&this._reset.complete()},e.prototype.isPathDirty=function(t){var e=this.getHead(),n=Xr(this.getQuery().getValue(),t),r=Xr(e,t);return this.params.comparator(n,r)},e.prototype.getHead=function(){return this.head},e.prototype.activate=function(){var t=this;this.head=this._getHead();var e=this.params.watchProperty?this.params.watchProperty.map((function(e){return t.query.select((function(t){return t[e]})).pipe(ee((function(t){return{val:t,__akitaKey:e}})))})):[this.selectSource(this._entityId)];this.subscription=pe.apply(void 0,Kn(e)).pipe(en(1)).subscribe((function(e){if(!xr(t.head)){var n=e.some((function(e){var n=e.__akitaKey?t.head[e.__akitaKey]:t.head,r=e.__akitaKey?e.val:e;return t.params.comparator(n,r)}));t.updateDirtiness(n)}}))},e.prototype.updateDirtiness=function(t){this.dirty.next(t)},e.prototype._getHead=function(){var t=this.getSource(this._entityId);return this.params.watchProperty&&(t=this.getWatchedValues(t)),t},e.prototype.getWatchedValues=function(t){return this.params.watchProperty.reduce((function(e,n){return e[n]=t[n],e}),{})},e}(Gr),ti=function(){function t(t,e){this.query=t,this.entityIds=e,this.entities=new Map}return t.prototype.getEntity=function(t){return this.entities.get(t)},t.prototype.hasEntity=function(t){return this.entities.has(t)},t.prototype.removeEntity=function(t){return this.destroy(t),this.entities.delete(t)},t.prototype.createEntity=function(t,e){return this.entities.set(t,e)},t.prototype.getIds=function(){return xr(this.entityIds)?this.query.getValue().ids:ir(this.entityIds)},t.prototype.resolvedIds=function(t){return xr(t)?this.getIds():ir(t)},t.prototype.rebase=function(t,e){var n=this;if(void 0===e&&(e={}),Ir(t))if(xr(this.entityIds)){for(var r=0,i=t.length;r<i;r++){var o=t[r];if(!1===this.hasEntity(o)){sr(e.beforeAdd)&&e.beforeAdd(o);var s=this.instantiatePlugin(o);this.entities.set(o,s),sr(e.afterAdd)&&e.afterAdd(s)}}this.entities.forEach((function(r,i){-1===t.indexOf(i)&&(sr(e.beforeRemove)&&e.beforeRemove(r),n.removeEntity(i))}))}else{var a=ir(this.entityIds);for(r=0,i=a.length;r<i;r++){o=a[r];if(t.indexOf(o)>-1&&!1===this.hasEntity(o)){sr(e.beforeAdd)&&e.beforeAdd(o);s=this.instantiatePlugin(o);this.entities.set(o,s),sr(e.afterAdd)&&e.afterAdd(s)}else this.entities.forEach((function(r,i){-1===t.indexOf(i)&&!0===n.hasEntity(i)&&(sr(e.beforeRemove)&&e.beforeRemove(r),n.removeEntity(i))}))}}else this.getIds().forEach((function(t){n.hasEntity(t)||n.createEntity(t,n.instantiatePlugin(t))}))},t.prototype.selectIds=function(){return this.query.select((function(t){return t.ids}))},t.prototype.activate=function(t){this.rebase(t)},t.prototype.forEachId=function(t,e){for(var n=this.resolvedIds(t),r=0,i=n.length;r<i;r++){var o=n[r];this.hasEntity(o)&&e(this.getEntity(o))}},t}();!function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this,e,n.entityIds)||this;return r.query=e,r.params=n,r._someDirty=new Tt,r.someDirty$=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Number.POSITIVE_INFINITY,r=null,i=t[t.length-1];return Lt(i)?(r=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof i&&(n=t.pop()),null===r&&1===t.length&&t[0]instanceof Et?t[0]:xe(n)(Bt(t,r))}(r.query.select((function(t){return t.entities})),r._someDirty.asObservable()).pipe(Fe(0),ee((function(){return r.checkSomeDirty()}))),r.params=Ln(Ln({},Jr),n),r.activate(),r.selectIds().pipe(en(1)).subscribe((function(e){t.prototype.rebase.call(r,e,{afterAdd:function(t){return t.setHead()}})})),r}Un(e,t),e.prototype.setHead=function(t){if(this.params.entityIds&&t){var e=ir(t);if(!1===ir(this.params.entityIds).some((function(t){return e.indexOf(t)>-1})))return this}return this.forEachId(t,(function(t){return t.setHead()})),this._someDirty.next(),this},e.prototype.hasHead=function(t){return!!this.entities.has(t)&&this.getEntity(t).hasHead()},e.prototype.reset=function(t,e){void 0===e&&(e={}),this.forEachId(t,(function(t){return t.reset(e)}))},e.prototype.isDirty=function(t,e){if(void 0===e&&(e=!0),this.entities.has(t)){var n=this.getEntity(t);return e?n.isDirty$:n.isDirty()}return!1},e.prototype.someDirty=function(){return this.checkSomeDirty()},e.prototype.isPathDirty=function(t,e){if(this.entities.has(t)){var n=this.getEntity(t).getHead(),r=Xr(this.query.getEntity(t),e),i=Xr(n,e);return this.params.comparator(r,i)}return null},e.prototype.destroy=function(t){this.forEachId(t,(function(t){return t.destroy()})),t||this._someDirty.complete()},e.prototype.instantiatePlugin=function(t){return new Zr(this.query,this.params,t)},e.prototype.checkSomeDirty=function(){var t,e,n=this.resolvedIds();try{for(var r=zn(n),i=r.next();!i.done;i=r.next()){var o=i.value;if(this.getEntity(o).isDirty())return!0}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return!1}}(ti);var ei={pagesControls:!1,range:!1,startWith:1,cacheTimeout:void 0,clearStoreWithCache:!0};!function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this,e,{resetFn:function(){r.initial=!1,r.destroy({clearCache:!0,currentPage:1})}})||this;r.query=e,r.config=n,r.metadata=new Map,r.pages=new Map,r.pagination={currentPage:1,perPage:0,total:0,lastPage:0,data:[]},r.initial=!0,r.isLoading$=r.query.selectLoading().pipe(Le(0)),r.config=Ln(Ln({},ei),n);var i=r.config,o=i.startWith,s=i.cacheTimeout;return r.page=new Nt(o),Zt(s)&&(r.clearCacheSubscription=s.subscribe((function(){return r.clearCache()}))),r}Un(e,t),Object.defineProperty(e.prototype,"pageChanges",{get:function(){return this.page.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return this.pagination.currentPage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFirst",{get:function(){return 1===this.currentPage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLast",{get:function(){return this.currentPage===this.pagination.lastPage},enumerable:!1,configurable:!0}),e.prototype.withControls=function(){return this.config.pagesControls=!0,this},e.prototype.withRange=function(){return this.config.range=!0,this},e.prototype.setLoading=function(t){void 0===t&&(t=!0),this.getStore().setLoading(t)},e.prototype.update=function(t){this.pagination=t,this.addPage(t.data)},e.prototype.addPage=function(t){var e=this;this.pages.set(this.currentPage,{ids:t.map((function(t){return t[e.getStore().idKey]}))}),this.getStore().upsertMany(t)},e.prototype.clearCache=function(t){void 0===t&&(t={}),this.initial||(Yn("@Pagination - Clear Cache"),!1!==t.clearStore&&(this.config.clearStoreWithCache||t.clearStore)&&this.getStore().remove(),this.pages=new Map,this.metadata=new Map),this.initial=!1},e.prototype.clearPage=function(t){this.pages.delete(t)},e.prototype.destroy=function(t){var e=void 0===t?{}:t,n=e.clearCache,r=e.currentPage;this.clearCacheSubscription&&this.clearCacheSubscription.unsubscribe(),n&&this.clearCache(),xr(r)||this.setPage(r),this.initial=!0},e.prototype.isPageActive=function(t){return this.currentPage===t},e.prototype.setPage=function(t){t===this.currentPage&&this.hasPage(t)||this.page.next(this.pagination.currentPage=t)},e.prototype.nextPage=function(){this.currentPage!==this.pagination.lastPage&&this.setPage(this.pagination.currentPage+1)},e.prototype.prevPage=function(){this.pagination.currentPage>1&&this.setPage(this.pagination.currentPage-1)},e.prototype.setLastPage=function(){this.setPage(this.pagination.lastPage)},e.prototype.setFirstPage=function(){this.setPage(1)},e.prototype.hasPage=function(t){return this.pages.has(t)},e.prototype.getPage=function(t){var e=this,n=this.pagination.currentPage;return this.hasPage(n)?this.selectPage(n):(this.setLoading(!0),ge(t()).pipe(sn((function(t){return n=t.currentPage,jr((function(){e.setLoading(!1),e.update(t)})),e.selectPage(n)}))))},e.prototype.getQuery=function(){return this.query},e.prototype.refreshCurrentPage=function(){!1===rr(this.currentPage)&&(this.clearPage(this.currentPage),this.setPage(this.currentPage))},e.prototype.getFrom=function(){return this.isFirst?1:(this.currentPage-1)*this.pagination.perPage+1},e.prototype.getTo=function(){return this.isLast?this.pagination.total:this.currentPage*this.pagination.perPage},e.prototype.selectPage=function(t){var e,n=this;return this.query.selectAll({asObject:!0}).pipe((e=1,function(t){return 0===e?Ut():t.lift(new qe(e))}),ee((function(e){var r=Ln(Ln({},n.pagination),{data:n.pages.get(t).ids.map((function(t){return e[t]}))}),i=n.config,o=i.range,s=i.pagesControls;return isNaN(n.pagination.total)&&(1===r.lastPage?r.total=r.data?r.data.length:0:r.total=r.perPage*r.lastPage,n.pagination.total=r.total),o&&(r.from=n.getFrom(),r.to=n.getTo()),s&&(r.pageControls=function(t,e){for(var n=Math.ceil(t/e),r=[],i=0;i<n;i++)r.push(i+1);return r}(n.pagination.total,n.pagination.perPage)),r})))},Mn([Jn("@Pagination - New Page"),Bn("design:type",Function),Bn("design:paramtypes",[Object]),Bn("design:returntype",void 0)],e.prototype,"update",null)}(Gr),function(t){function e(e,n,r){void 0===r&&(r={});var i=t.call(this,e)||this;return i.query=e,i.factoryFnOrPath=n,i.params=r,i.params=Ln({debounceTime:300,formKey:"akitaForm",emitEvent:!1,arrControlFactory:function(t){return i.builder.control(t)}},r),i.isRootKeys=!1===Ir(n),i.isKeyBased=Ur(n)||i.isRootKeys,i}Un(e,t),e.prototype.setForm=function(t,e){return this.form=t,this.builder=e,this.activate(),this},e.prototype.reset=function(t){var e,n,r=this;n=t||(this.isKeyBased?this.initialValue:this.factoryFnOrPath()),this.isKeyBased&&Object.keys(this.initialValue).forEach((function(t){var e=r.initialValue[t];if(Array.isArray(e)&&r.builder){var n=r.form.controls[t];r.cleanArray(n),e.forEach((function(e,n){r.form.get(t).insert(n,r.params.arrControlFactory(e))}))}})),this.form.patchValue(n,{emitEvent:this.params.emitEvent});var i=this.isKeyBased?Kr(this.getQuery().getValue(),this.getStore().storeName+"."+this.factoryFnOrPath,n):((e={})[this.params.formKey]=n,e);this.updateStore(i)},e.prototype.cleanArray=function(t){for(;0!==t.length;)t.removeAt(0)},e.prototype.resolveInitialValue=function(t,e){var n=this;if(t)return Object.keys(t).reduce((function(t,r){var i=e[r];if(Array.isArray(i)&&n.builder){var o=n.params.arrControlFactory;n.cleanArray(n.form.get(r)),i.forEach((function(t,e){n.form.get(r).insert(e,o(t))}))}return t[r]=e[r],t}),{})},e.prototype.activate=function(){var t,e,n,r,i=this;if(this.isKeyBased)if(this.isRootKeys)this.initialValue=this.resolveInitialValue(this.form.value,this.getQuery().getValue()),this.form.patchValue(this.initialValue,{emitEvent:this.params.emitEvent});else{e=this.getStore().storeName+"."+this.factoryFnOrPath;var o=Wr(this.getQuery().getValue(),e);this.initialValue=this.resolveInitialValue(o,o),this.form.patchValue(this.initialValue,{emitEvent:this.params.emitEvent})}else{this.getQuery().getValue()[this.params.formKey]||(Yn("@PersistNgFormPlugin activate"),this.updateStore(((t={})[this.params.formKey]=this.factoryFnOrPath(),t)));var s=this.getQuery().getValue()[this.params.formKey];this.form.patchValue(s)}this.formChanges=this.form.valueChanges.pipe((n=this.params.debounceTime,void 0===r&&(r=Jt),function(t){return t.lift(new He(n,r))})).subscribe((function(t){var n;Yn("@PersistForm - Update"),n=i.isKeyBased?i.isRootKeys?function(e){return Ln(Ln({},e),t)}:function(n){return Kr(n,e,t)}:function(){var e;return(e={})[i.params.formKey]=t,e},i.updateStore(n(i.getQuery().getValue()))}))},e.prototype.destroy=function(){this.formChanges&&this.formChanges.unsubscribe(),this.form=null,this.builder=null}}(Gr);var ni,ri,ii,oi=function(t){function e(e,n,r){void 0===n&&(n={});var i=t.call(this,e,{resetFn:function(){return i.clear()}})||this;return i.query=e,i.params=n,i._entityId=r,i.skip=!1,i.history={past:[],present:null,future:[]},i.skipUpdate=!1,n.maxAge=n.maxAge?n.maxAge:10,n.comparator=n.comparator||function(){return!0},i.activate(),i}return Un(e,t),Object.defineProperty(e.prototype,"hasPast$",{get:function(){return this._hasPast$},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasFuture$",{get:function(){return this._hasFuture$},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPast",{get:function(){return this.history.past.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasFuture",{get:function(){return this.history.future.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"property",{get:function(){return this.params.watchProperty},enumerable:!1,configurable:!0}),e.prototype.updateHasHistory=function(){this.hasFutureSubject.next(this.hasFuture),this.hasPastSubject.next(this.hasPast)},e.prototype.activate=function(){var t=this;this.hasPastSubject=new Nt(!1),this._hasPast$=this.hasPastSubject.asObservable().pipe(ze()),this.hasFutureSubject=new Nt(!1),this._hasFuture$=this.hasFutureSubject.asObservable().pipe(ze()),this.history.present=this.getSource(this._entityId,this.property),this.subscription=this.selectSource(this._entityId,this.property).pipe((function(t){return t.lift(new Je)})).subscribe((function(e){var n=Wn(e,2),r=n[0],i=n[1];if(t.skip)t.skip=!1;else{var o=t.params.comparator(r,i);!t.skipUpdate&&o&&(t.history.past.length===t.params.maxAge&&(t.history.past=t.history.past.slice(1)),t.history.past=Kn(t.history.past,[r]),t.history.present=i,t.updateHasHistory())}}))},e.prototype.undo=function(){if(this.history.past.length>0){var t=this.history,e=t.past,n=t.present,r=e[e.length-1];this.history.past=e.slice(0,e.length-1),this.history.present=r,this.history.future=Kn([n],this.history.future),this.update()}},e.prototype.redo=function(){if(this.history.future.length>0){var t=this.history,e=t.past,n=t.present,r=this.history.future[0],i=this.history.future.slice(1);this.history.past=Kn(e,[n]),this.history.present=r,this.history.future=i,this.update("Redo")}},e.prototype.jumpToPast=function(t){if(!(t<0||t>=this.history.past.length)){var e=this.history,n=e.past,r=e.future,i=e.present,o=n.slice(0,t),s=Kn(n.slice(t+1),[i],r),a=n[t];this.history.past=o,this.history.present=a,this.history.future=s,this.update()}},e.prototype.jumpToFuture=function(t){if(!(t<0||t>=this.history.future.length)){var e=this.history,n=e.past,r=e.future,i=Kn(n,[e.present],r.slice(0,t)),o=r[t],s=r.slice(t+1);this.history.past=i,this.history.present=o,this.history.future=s,this.update("Redo")}},e.prototype.jump=function(t){return t>0?this.jumpToFuture(t-1):t<0?this.jumpToPast(this.history.past.length+t):void 0},e.prototype.clear=function(t){this.history=sr(t)?t(this.history):{past:[],present:null,future:[]},this.updateHasHistory()},e.prototype.destroy=function(t){void 0===t&&(t=!1),t&&this.clear(),this.subscription.unsubscribe()},e.prototype.ignoreNext=function(){this.skip=!0},e.prototype.update=function(t){void 0===t&&(t="Undo"),this.skipUpdate=!0,Yn("@StateHistory - "+t),this.updateStore(this.history.present,this._entityId,this.property,!0),this.updateHasHistory(),this.skipUpdate=!1},e}(Gr);!function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this,e,n.entityIds)||this;return r.query=e,r.params=n,n.maxAge=Ir(n.maxAge)?n.maxAge:10,r.activate(),r.selectIds().pipe(en(1)).subscribe((function(t){return r.activate(t)})),r}Un(e,t),e.prototype.redo=function(t){this.forEachId(t,(function(t){return t.redo()}))},e.prototype.undo=function(t){this.forEachId(t,(function(t){return t.undo()}))},e.prototype.hasPast=function(t){if(this.hasEntity(t))return this.getEntity(t).hasPast},e.prototype.hasFuture=function(t){if(this.hasEntity(t))return this.getEntity(t).hasFuture},e.prototype.jumpToFuture=function(t,e){this.forEachId(t,(function(t){return t.jumpToFuture(e)}))},e.prototype.jumpToPast=function(t,e){this.forEachId(t,(function(t){return t.jumpToPast(e)}))},e.prototype.clear=function(t){this.forEachId(t,(function(t){return t.clear()}))},e.prototype.destroy=function(t,e){void 0===e&&(e=!1),this.forEachId(t,(function(t){return t.destroy(e)}))},e.prototype.ignoreNext=function(t){this.forEachId(t,(function(t){return t.ignoreNext()}))},e.prototype.instantiatePlugin=function(t){return new oi(this.query,this.params,t)}}(ti),function(t){t.Update="UPDATE"}(ri||(ri={})),{}[ri.Update]="update",function(t){t.Update="UPDATE",t.AddEntities="ADD_ENTITIES",t.SetEntities="SET_ENTITIES",t.UpdateEntities="UPDATE_ENTITIES",t.RemoveEntities="REMOVE_ENTITIES",t.UpsertEntities="UPSERT_ENTITIES",t.UpsertManyEntities="UPSERT_MANY_ENTITIES"}(ii||(ii={})),(ni={})[ii.Update]="update",ni[ii.AddEntities]="add",ni[ii.SetEntities]="set",ni[ii.UpdateEntities]="update",ni[ii.RemoveEntities]="remove",ni[ii.UpsertEntities]="upsert",ni[ii.UpsertManyEntities]="upsertMany";const si=t=>({matrix:bn.getStartBoard(),current:null,next:t.getRandomPiece(),points:0,locked:!0,sound:!0,initLine:0,clearedLines:0,initSpeed:1,speed:1,gameState:pn.Loading,saved:null,max:gn()}),ai=Br(si(new Hn),{name:"SvelteTetris"}),ui=zr(ai),ci=ui.select("next"),li=ui.select("matrix"),fi=ui.select("sound"),hi=ui.select("gameState"),pi=ui.select("current").pipe(ee((t=>!!t)));ui.select("points");const di=ui.select("clearedLines"),yi=ui.select("initLine"),mi=ui.select("speed"),gi=ui.select("initSpeed");ui.select("max");const vi=pe([hi,ui.select("current")]).pipe(sn((([t,e])=>{const n=t===pn.Loading||t===pn.Over,r=zt(n&&!e);return n?r.pipe(Le(1800)):r})));function bi(){return ui.getValue()}function wi(){return bi().current}function $i(e){let n,r,i,o,s;return{c(){n=f("div"),r=f("div"),o=p(),s=f("p"),s.textContent="Press Space to start",m(r,"class",i="bg dragon "+e[0]+" svelte-kn35yz"),m(s,"class","svelte-kn35yz"),m(n,"class","logo svelte-kn35yz")},m(t,e){u(t,n,e),a(n,r),a(n,o),a(n,s)},p(t,[e]){1&e&&i!==(i="bg dragon "+t[0]+" svelte-kn35yz")&&m(r,"class",i)},i:t,o:t,d(t){t&&c(n)}}}function _i(t,e,n){let r,i="";function o(){let t="r";return Ne(0,100).pipe(on(0),ee((t=>t+1)),cn((t=>t<=40)),hn((e=>{10!==e&&20!==e&&30!==e||(t="r"===t?"l":"r");n(0,i=`${t}${e%2==0?3:4}`)})),(e=()=>{n(0,i=`${t}1`)},function(t){return t.lift(new Ye(e))}));var e}return x((()=>{var t;r=Pe(o(),Ne(0,500).pipe(on(0),ee((t=>t+1)),cn((t=>t<6)),hn((t=>{n(0,i="l"+(t%2==0?1:2))})))).pipe(Le(5e3),(t=1e3,void 0===t&&(t=-1),function(e){return 0===t?Ut():t<0?e.lift(new Ze(-1,e)):e.lift(new Ze(t-1,e))})).subscribe()})),E((()=>r.unsubscribe())),[i]}class Si extends G{constructor(t){super(),Y(this,t,_i,$i,o,{})}}function xi(t,e,n){const r=t.slice();return r[4]=e[n],r}function Ei(t){let e,n;return{c(){e=f("span"),m(e,"class",n="bg num num-"+t[4]+" svelte-tsmjly")},m(t,n){u(t,e,n)},p(t,r){1&r&&n!==(n="bg num num-"+t[4]+" svelte-tsmjly")&&m(e,"class",n)},d(t){t&&c(e)}}}function Pi(e){let n,r=e[0],i=[];for(let t=0;t<r.length;t+=1)i[t]=Ei(xi(e,r,t));return{c(){n=f("div");for(let t=0;t<i.length;t+=1)i[t].c();m(n,"class","number svelte-tsmjly")},m(t,e){u(t,n,e);for(let t=0;t<i.length;t+=1)i[t].m(n,null)},p(t,[e]){if(1&e){let o;for(r=t[0],o=0;o<r.length;o+=1){const s=xi(t,r,o);i[o]?i[o].p(s,e):(i[o]=Ei(s),i[o].c(),i[o].m(n,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}},i:t,o:t,d(t){t&&c(n),l(i,t)}}}function ki(t,e,n){let r,{num:i=0}=e,{length:o=6}=e;function s(){return`${i}`.padStart(o,"n").split("")}return S((()=>{n(0,r=s())})),t.$$set=t=>{"num"in t&&n(1,i=t.num),"length"in t&&n(2,o=t.length)},[r,i,o,s]}class Oi extends G{constructor(t){super(),Y(this,t,ki,Pi,o,{num:1,length:2,nums:3})}get nums(){return this.$$.ctx[3]}}function Ii(t){let e,n,r,i,o,s,l=t[0].label+"";return o=new Oi({props:{num:t[0].points}}),{c(){e=f("div"),n=f("p"),r=h(l),i=p(),W(o.$$.fragment)},m(t,c){u(t,e,c),a(e,n),a(n,r),a(e,i),K(o,e,null),s=!0},p(t,e){(!s||1&e)&&l!==(l=t[0].label+"")&&g(r,l);const n={};1&e&&(n.num=t[0].points),o.$set(n)},i(t){s||(B(o.$$.fragment,t),s=!0)},o(t){z(o.$$.fragment,t),s=!1},d(t){t&&c(e),q(o)}}}function Ti(t){let e,n,r=t[0]&&Ii(t);return{c(){r&&r.c(),e=d()},m(t,i){r&&r.m(t,i),u(t,e,i),n=!0},p(t,[n]){t[0]?r?(r.p(t,n),1&n&&B(r,1)):(r=Ii(t),r.c(),B(r,1),r.m(e.parentNode,e)):r&&(V(),z(r,1,1,(()=>{r=null})),M())},i(t){n||(B(r),n=!0)},o(t){z(r),n=!1},d(t){r&&r.d(t),t&&c(e)}}}function Ai(t,e,n){class r{constructor(t,e){this.label=t,this.points=e}}let i;return x((()=>{pi.pipe(sn((t=>t?zt(new r("Score",bi().points)):Ne(0,3e3).pipe(ee((t=>{const e=t%2==0,{points:n,max:i}=bi();return e?new r("Score",n):new r("Max ",i)})))))).subscribe((t=>{n(0,i=t)}))})),[i]}class Ni extends G{constructor(t){super(),Y(this,t,Ai,Ti,o,{})}}function Ci(t){let e;return{c(){e=h("Start Line")},m(t,n){u(t,e,n)},d(t){t&&c(e)}}}function Di(t){let e;return{c(){e=f("span"),e.textContent="Lines"},m(t,n){u(t,e,n)},d(t){t&&c(e)}}}function ji(t){let e,n;return e=new Oi({props:{num:t[2]}}),{c(){W(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.num=t[2]),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Fi(t){let e,n;return e=new Oi({props:{num:t[1]}}),{c(){W(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};2&n&&(r.num=t[1]),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Hi(t){let e,n,r,i,o,s;function a(t,e){return t[0]?Di:Ci}let l=a(t),h=l(t);const y=[Fi,ji],m=[];function g(t,e){return t[0]?0:1}return r=g(t),i=m[r]=y[r](t),{c(){e=f("p"),h.c(),n=p(),i.c(),o=d()},m(t,i){u(t,e,i),h.m(e,null),u(t,n,i),m[r].m(t,i),u(t,o,i),s=!0},p(t,[n]){l!==(l=a(t))&&(h.d(1),h=l(t),h&&(h.c(),h.m(e,null)));let s=r;r=g(t),r===s?m[r].p(t,n):(V(),z(m[s],1,1,(()=>{m[s]=null})),M(),i=m[r],i?i.p(t,n):(i=m[r]=y[r](t),i.c()),B(i,1),i.m(o.parentNode,o))},i(t){s||(B(i),s=!0)},o(t){z(i),s=!1},d(t){t&&c(e),h.d(),t&&c(n),m[r].d(t),t&&c(o)}}}function Ri(t,e,n){let r,i,o;return x((()=>{pi.subscribe((t=>n(0,r=t))),di.subscribe((t=>n(1,i=t))),yi.subscribe((t=>n(2,o=t)))})),[r,i,o]}class Ui extends G{constructor(t){super(),Y(this,t,Ri,Hi,o,{})}}function Li(t){let e,n;return e=new Oi({props:{num:t[1],length:1}}),{c(){W(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};2&n&&(r.num=t[1]),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Vi(t){let e,n;return e=new Oi({props:{num:t[0],length:1}}),{c(){W(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.num=t[0]),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Mi(t){let e,n,r,i,o,s;const a=[Vi,Li],l=[];function h(t,e){return t[2]?0:1}return r=h(t),i=l[r]=a[r](t),{c(){e=f("p"),e.textContent="Level",n=p(),i.c(),o=d()},m(t,i){u(t,e,i),u(t,n,i),l[r].m(t,i),u(t,o,i),s=!0},p(t,[e]){let n=r;r=h(t),r===n?l[r].p(t,e):(V(),z(l[n],1,1,(()=>{l[n]=null})),M(),i=l[r],i?i.p(t,e):(i=l[r]=a[r](t),i.c()),B(i,1),i.m(o.parentNode,o))},i(t){s||(B(i),s=!0)},o(t){z(i),s=!1},d(t){t&&c(e),t&&c(n),l[r].d(t),t&&c(o)}}}function Bi(t,e,n){let r,i,o,s,a,u;return x((()=>{r=mi.subscribe((t=>n(0,s=t))),i=gi.subscribe((t=>n(1,a=t))),o=pi.subscribe((t=>n(2,u=t)))})),E((()=>{r.unsubscribe(),i.unsubscribe(),o.unsubscribe()})),[s,a,u]}class zi extends G{constructor(t){super(),Y(this,t,Bi,Mi,o,{})}}function Wi(t,e,n){const r=t.slice();return r[2]=e[n],r}function Ki(t,e,n){const r=t.slice();return r[5]=e[n],r}function qi(t){let e,n;return e=new nt({props:{tile:t[5]}}),{c(){W(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.tile=t[5]),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Qi(t){let e,n,r,i=t[2],o=[];for(let e=0;e<i.length;e+=1)o[e]=qi(Ki(t,i,e));const s=t=>z(o[t],1,1,(()=>{o[t]=null}));return{c(){e=f("div");for(let t=0;t<o.length;t+=1)o[t].c();n=p(),m(e,"class","row svelte-zzeyfs")},m(t,i){u(t,e,i);for(let t=0;t<o.length;t+=1)o[t].m(e,null);a(e,n),r=!0},p(t,r){if(1&r){let a;for(i=t[2],a=0;a<i.length;a+=1){const s=Ki(t,i,a);o[a]?(o[a].p(s,r),B(o[a],1)):(o[a]=qi(s),o[a].c(),B(o[a],1),o[a].m(e,n))}for(V(),a=i.length;a<o.length;a+=1)s(a);M()}},i(t){if(!r){for(let t=0;t<i.length;t+=1)B(o[t]);r=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)z(o[t]);r=!1},d(t){t&&c(e),l(o,t)}}}function Yi(t){let e,n,r,i,o=t[0],s=[];for(let e=0;e<o.length;e+=1)s[e]=Qi(Wi(t,o,e));const a=t=>z(s[t],1,1,(()=>{s[t]=null}));return{c(){e=f("p"),e.textContent="Next",n=p(),r=f("div");for(let t=0;t<s.length;t+=1)s[t].c();m(r,"class","next svelte-zzeyfs")},m(t,o){u(t,e,o),u(t,n,o),u(t,r,o);for(let t=0;t<s.length;t+=1)s[t].m(r,null);i=!0},p(t,[e]){if(1&e){let n;for(o=t[0],n=0;n<o.length;n+=1){const i=Wi(t,o,n);s[n]?(s[n].p(i,e),B(s[n],1)):(s[n]=Qi(i),s[n].c(),B(s[n],1),s[n].m(r,null))}for(V(),n=o.length;n<s.length;n+=1)a(n);M()}},i(t){if(!i){for(let t=0;t<o.length;t+=1)B(s[t]);i=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)z(s[t]);i=!1},d(t){t&&c(e),t&&c(n),t&&c(r),l(s,t)}}}function Gi(t,e,n){let r,i=[];return x((()=>{r=ci.pipe(ee((t=>t.next.map((t=>t.map((t=>new J(t)))))))).subscribe((t=>n(0,i=t)))})),E((()=>{r.unsubscribe()})),[i]}class Ji extends G{constructor(t){super(),Y(this,t,Gi,Yi,o,{})}}function Xi(e){let n;return{c(){n=f("div"),m(n,"class","bg music svelte-1tdw0aj"),b(n,"filled",e[0])},m(t,e){u(t,n,e)},p(t,[e]){1&e&&b(n,"filled",t[0])},i:t,o:t,d(t){t&&c(n)}}}function Zi(t,e,n){let r,i;return x((()=>{r=fi.pipe(ee((t=>!t))).subscribe((t=>n(0,i=t)))})),E((()=>r.unsubscribe())),[i]}class to extends G{constructor(t){super(),Y(this,t,Zi,Xi,o,{})}}function eo(e){let n;return{c(){n=f("div"),m(n,"class","bg pause svelte-2b203i"),b(n,"filled",e[0])},m(t,e){u(t,n,e)},p(t,[e]){1&e&&b(n,"filled",t[0])},i:t,o:t,d(t){t&&c(n)}}}function no(t,e,n){let r,i;return x((()=>{r=hi.pipe(sn((t=>{return t===pn.Paused?(e=250,void 0===e&&(e=0),void 0===n&&(n=Jt),(!ke(e)||e<0)&&(e=0),n&&"function"==typeof n.schedule||(n=Jt),new Et((function(t){return t.add(n.schedule(Oe,e,{subscriber:t,counter:0,period:e})),t}))).pipe(ee((t=>!!(t%2)))):zt(!1);var e,n}))).subscribe((t=>n(0,i=t)))})),E((()=>r.unsubscribe())),[i]}class ro extends G{constructor(t){super(),Y(this,t,no,eo,o,{})}}function io(t,e,n){const r=t.slice();return r[2]=e[n],r}function oo(t){let e,n;return{c(){e=f("span"),m(e,"class",n="bg num num-"+t[2]+" svelte-tsmjly")},m(t,n){u(t,e,n)},p(t,r){1&r&&n!==(n="bg num num-"+t[2]+" svelte-tsmjly")&&m(e,"class",n)},d(t){t&&c(e)}}}function so(e){let n,r=e[0],i=[];for(let t=0;t<r.length;t+=1)i[t]=oo(io(e,r,t));return{c(){n=f("div");for(let t=0;t<i.length;t+=1)i[t].c();m(n,"class","number svelte-tsmjly")},m(t,e){u(t,n,e);for(let t=0;t<i.length;t+=1)i[t].m(n,null)},p(t,[e]){if(1&e){let o;for(r=t[0],o=0;o<r.length;o+=1){const s=io(t,r,o);i[o]?i[o].p(s,e):(i[o]=oo(s),i[o].c(),i[o].m(n,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}},i:t,o:t,d(t){t&&c(n),l(i,t)}}}function ao(t){return`${t}`.padStart(2,"0").split("")}function uo(t,e,n){let r,i=[];return x((()=>{r=Ne(0,1e3).pipe(ee((()=>function(){const t=new Date,e=ao(t.getHours()),n=ao(t.getMinutes());return[...e,"colon-"+(t.getSeconds()%2!=0?"solid":"faded"),...n]}()))).subscribe((t=>n(0,i=t)))})),E((()=>{r.unsubscribe()})),[i]}class co extends G{constructor(t){super(),Y(this,t,uo,so,o,{})}}const lo=Br({up:!1,down:!1,left:!1,right:!1,pause:!1,sound:!1,reset:!1,drop:!1},{name:"SvelteTetrisKeyboard"}),fo=zr(lo),ho=fo.select("up"),po=fo.select("down"),yo=fo.select("left"),mo=fo.select("right"),go=fo.select("drop"),vo=fo.select("pause"),bo=fo.select("sound"),wo=fo.select("reset");var $o;!function(t){t.UP="UP",t.DOWN="DOWN",t.LEFT="LEFT",t.RIGHT="RIGHT"}($o||($o={}));const _o={[$o.UP]:"translate(0px, 63px) scale(1, 2)",[$o.DOWN]:"translate(0,-71px) rotate(180deg) scale(1, 2)",[$o.LEFT]:"translate(60px, -12px) rotate(270deg) scale(1, 2)",[$o.RIGHT]:"translate(-60px, -12px) rotate(90deg) scale(1, 2)"};function So(e){let n;return{c(){n=f("em"),v(n,"transform",e[7]()),m(n,"class","svelte-qhatfd")},m(t,e){u(t,n,e)},p:t,d(t){t&&c(n)}}}function xo(e){let n,i,o,s,l,d,w,$,_,S=e[4]&&So(e);return{c(){n=f("div"),i=f("i"),o=p(),S&&S.c(),s=p(),l=f("span"),d=h(e[5]),m(i,"class","svelte-qhatfd"),b(i,"active",e[6]),m(l,"class","svelte-qhatfd"),b(l,"absolute",e[1]),m(n,"class",w="button "+e[0]+" svelte-qhatfd"),v(n,"top",e[2]+"px"),v(n,"left",e[3]+"px")},m(t,r){u(t,n,r),a(n,i),a(n,o),S&&S.m(n,null),a(n,s),a(n,l),a(l,d),$||(_=[y(n,"mousedown",e[8]),y(n,"mouseup",e[9]),y(n,"touchstart",e[8],{passive:!0}),y(n,"touchend",e[9],{passive:!0})],$=!0)},p(t,[e]){64&e&&b(i,"active",t[6]),t[4]?S?S.p(t,e):(S=So(t),S.c(),S.m(n,s)):S&&(S.d(1),S=null),32&e&&g(d,t[5]),2&e&&b(l,"absolute",t[1]),1&e&&w!==(w="button "+t[0]+" svelte-qhatfd")&&m(n,"class",w),4&e&&v(n,"top",t[2]+"px"),8&e&&v(n,"left",t[3]+"px")},i:t,o:t,d(t){t&&c(n),S&&S.d(),$=!1,r(_)}}}function Eo(t,e,n){let r,{className:i=""}=e,{isAbsolute:o=!1}=e,{top:s}=e,{left:a}=e,{active$:u}=e,{arrowButton:c}=e,{content:l}=e,{key:f}=e;x((()=>{})),u.subscribe((t=>{n(6,r=t)})),S((()=>{u.subscribe((t=>{n(6,r=t)}))}));const h=P();return t.$$set=t=>{"className"in t&&n(0,i=t.className),"isAbsolute"in t&&n(1,o=t.isAbsolute),"top"in t&&n(2,s=t.top),"left"in t&&n(3,a=t.left),"active$"in t&&n(10,u=t.active$),"arrowButton"in t&&n(4,c=t.arrowButton),"content"in t&&n(5,l=t.content),"key"in t&&n(11,f=t.key)},[i,o,s,a,c,l,r,function(){return _o[c]},function(){h("mousekeydown",{key:f})},function(){h("mousekeyup",{key:f})},u,f]}class Po extends G{constructor(t){super(),Y(this,t,Eo,xo,o,{className:0,isAbsolute:1,top:2,left:3,active$:10,arrowButton:4,content:5,key:11})}}function ko(t){let e,n,r,i,o,s,l,h,d,y,g,b,w,$,_,S,x;return n=new Po({props:{className:"blue btn-md",content:"Rotation",active$:ho,arrowButton:$o.UP,top:0,left:100,isAbsolute:!0,key:"Up"}}),n.$on("mousekeydown",t[1]),n.$on("mousekeyup",t[2]),i=new Po({props:{className:"blue btn-md",content:"Down",active$:po,arrowButton:$o.DOWN,top:180,left:100,key:"Down"}}),i.$on("mousekeydown",t[1]),i.$on("mousekeyup",t[2]),s=new Po({props:{className:"blue btn-md",content:"Left",active$:yo,arrowButton:$o.LEFT,top:90,left:10,key:"Left"}}),s.$on("mousekeydown",t[1]),s.$on("mousekeyup",t[2]),h=new Po({props:{className:"blue btn-md",content:"Right",active$:mo,arrowButton:$o.RIGHT,top:90,left:190,key:"Right"}}),h.$on("mousekeydown",t[1]),h.$on("mousekeyup",t[2]),y=new Po({props:{className:"blue btn-lg",content:"Drop (SPACE)",active$:go,top:100,left:374,key:"Space"}}),y.$on("mousekeydown",t[1]),y.$on("mousekeyup",t[2]),b=new Po({props:{className:"red btn-sm",content:"Reset (R)",active$:wo,top:0,left:480,key:"Reset"}}),b.$on("mousekeydown",t[1]),b.$on("mousekeyup",t[2]),$=new Po({props:{className:"green btn-sm",content:"Sound (S)",active$:bo,top:0,left:390,key:"Sound"}}),$.$on("mousekeydown",t[1]),$.$on("mousekeyup",t[2]),S=new Po({props:{className:"green btn-sm",content:"Pause (P)",active$:vo,top:0,left:300,key:"Pause"}}),S.$on("mousekeydown",t[1]),S.$on("mousekeyup",t[2]),{c(){e=f("div"),W(n.$$.fragment),r=p(),W(i.$$.fragment),o=p(),W(s.$$.fragment),l=p(),W(h.$$.fragment),d=p(),W(y.$$.fragment),g=p(),W(b.$$.fragment),w=p(),W($.$$.fragment),_=p(),W(S.$$.fragment),m(e,"class","keyboard svelte-147dxtc"),v(e,"margin-top",t[0]+"px")},m(t,c){u(t,e,c),K(n,e,null),a(e,r),K(i,e,null),a(e,o),K(s,e,null),a(e,l),K(h,e,null),a(e,d),K(y,e,null),a(e,g),K(b,e,null),a(e,w),K($,e,null),a(e,_),K(S,e,null),x=!0},p(t,[n]){(!x||1&n)&&v(e,"margin-top",t[0]+"px")},i(t){x||(B(n.$$.fragment,t),B(i.$$.fragment,t),B(s.$$.fragment,t),B(h.$$.fragment,t),B(y.$$.fragment,t),B(b.$$.fragment,t),B($.$$.fragment,t),B(S.$$.fragment,t),x=!0)},o(t){z(n.$$.fragment,t),z(i.$$.fragment,t),z(s.$$.fragment,t),z(h.$$.fragment,t),z(y.$$.fragment,t),z(b.$$.fragment,t),z($.$$.fragment,t),z(S.$$.fragment,t),x=!1},d(t){t&&c(e),q(n),q(i),q(s),q(h),q(y),q(b),q($),q(S)}}}function Oo(t,e,n){const r=P();let{filling:i=20}=e;return t.$$set=t=>{"filling"in t&&n(0,i=t.filling)},[i,function(t){t.preventDefault(),r("mousekeydown",{key:t.detail.key})},function(t){t.preventDefault(),r("mousekeyup",{key:t.detail.key})}]}class Io extends G{constructor(t){super(),Y(this,t,Oo,ko,o,{filling:0})}}function To(t,e,n){const r=t.slice();return r[3]=e[n],r}function Ao(t){let e,n;return e=new nt({props:{tile:t[3]}}),{c(){W(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.tile=t[3]),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function No(t){let e,n,r=t[0],i=[];for(let e=0;e<r.length;e+=1)i[e]=Ao(To(t,r,e));const o=t=>z(i[t],1,1,(()=>{i[t]=null}));return{c(){e=f("div");for(let t=0;t<i.length;t+=1)i[t].c();m(e,"class","matrix svelte-1i6o7og")},m(t,r){u(t,e,r);for(let t=0;t<i.length;t+=1)i[t].m(e,null);n=!0},p(t,[n]){if(1&n){let s;for(r=t[0],s=0;s<r.length;s+=1){const o=To(t,r,s);i[s]?(i[s].p(o,n),B(i[s],1)):(i[s]=Ao(o),i[s].c(),B(i[s],1),i[s].m(e,null))}for(V(),s=r.length;s<i.length;s+=1)o(s);M()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)B(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)z(i[t]);n=!1},d(t){t&&c(e),l(i,t)}}}function Co(t,e,n){let r,i=[];return x((()=>{r=pe([hi,li]).pipe(sn((([t,e])=>{if(t!==pn.Over&&t!==pn.Loading)return zt(e);const n=[...e],r=2*bn.Height;return Ne(0,r).pipe(ee((t=>t+1)),cn((t=>t<=r+1)),sn((t=>{const e=t-1;if(e<bn.Height&&n.splice(e*bn.Width,bn.Width,...bn.FullRow),e>bn.Height&&e<=r){const t=(bn.Height-(e-bn.Height))*bn.Width;n.splice(t,bn.Width,...bn.EmptyRow)}return zt(n)})))}))).subscribe((t=>n(0,i=t)))})),E((()=>{console.log("destroy"),r.unsubscribe()})),[i]}class Do extends G{constructor(t){super(),Y(this,t,Co,No,o,{})}}const jo="/assets/tetris-sound.mp3";let Fo,Ho,Ro;function Uo(){Lo(0,2.9088,.1437)}function Lo(t,e,n){bi().sound&&new Promise(((t,e)=>{if(Fo&&Ho)return void t(Vo(Fo,Ho));const n=new AudioContext,r=new XMLHttpRequest;r.open("GET",jo,!0),r.responseType="arraybuffer",r.onload=()=>{n.decodeAudioData(r.response,(e=>{Fo=n,Ho=e,t(Vo(n,e))}),(()=>{const t="Sorry, cannot play sound. But I hope you still enjoy Svelte Tetris!!!";alert(t),e(t)}))},r.send()})).then((r=>{r&&r.start(t,e,n)}))}function Vo(t,e){const n=t.createBufferSource();return n.buffer=e,n.connect(t.destination),n}function Mo(t){lo.update(t)}const Bo=new Hn;function zo(){return bi().locked}function Wo(){return wi()}function Ko(){return bi().next}function qo(){return bi().matrix}function Qo(t){Ro=Ne(0,t).subscribe((()=>{Xo()}))}function Yo(){if(bi().gameState!==pn.Paused)return;const{speed:t}=bi();ai.update({locked:!1,gameState:pn.Started}),Qo(bn.getSpeedDelay(t))}function Go(){bi().gameState===pn.Started&&(ai.update({locked:!0,gameState:pn.Paused}),fs())}function Jo(){const{sound:t}=bi();ai.update(Object.assign(Object.assign({},si(Bo)),{sound:t}))}function Xo(){zo()||(ls(!0),us(Wo().revert()),is(),us(Wo().store()),us(Wo().moveDown()),Zo()&&(us(Wo().revert()),os((t=>{ss(t,new X(!0))})),rs(),function(){let t=0;const e=[...qo()];for(let n=bn.Height-1;n>=0;n--){const r=n*bn.Width;if(e.slice(r,r+bn.Width).every((t=>t.isSolid))){t++;const r=qo().slice(0,n*bn.Width);e.splice(0,++n*bn.Width,...bn.EmptyRow.concat(r)),cs(e)}}!function(t){if(!t)return;Lo(0,0,.7675);const{points:e,clearedLines:n,speed:r,initSpeed:i}=bi(),o=n+t,s=function(t,e){const n=bn.Points[t-1],r=e+n;return r>bn.MaxPoint?bn.MaxPoint:r}(t,e),a=function(t,e){const n=Math.floor(t/bn.Height);let r=e+n;return r=r>6?6:r,r}(o,i);ai.update({points:s,clearedLines:o,speed:a}),a!==r&&(fs(),Qo(bn.getSpeedDelay(a)))}(t)}(),us(Ko()),as(),function(){if(us(Wo().store()),us(Wo().moveDown()),Zo())return!0;return us(Wo().revert()),!1}())?function(){Go(),Lo(0,8.1276,1.1437);const{points:t,max:e,sound:n}=bi(),r=Math.max(t,e);(function(t){localStorage.setItem(mn,`${t}`)})(r),ai.update(Object.assign(Object.assign({},si(Bo)),{max:r,gameState:pn.Over,sound:n}))}():(rs(),ls(!1)))}function Zo(){return Wo().bottomRow>=bn.Height||ns()}function ts(){return Wo().leftCol<0||ns()}function es(){return Wo().rightCol>=bn.Width||ns()}function ns(){return Wo().positionOnGrid.some((t=>!!qo()[t].isSolid))}function rs(){us(Wo().clearStore()),os((t=>{const e=qo()[t].isSolid;ss(t,new X(e))}))}function is(){os((t=>{ss(t,new vn)}))}function os(t){Wo().positionOnGrid.forEach((e=>{t(e)}))}function ss(t,e){const n=[...qo()];n[t]=e,cs(n)}function as(){ai.update({next:Bo.getRandomPiece()})}function us(t){ai.update({current:t})}function cs(t){ai.update({matrix:t})}function ls(t){ai.update({locked:t})}function fs(){Ro&&Ro.unsubscribe()}function hs(t){var e={exports:{}};return t(e,e.exports),e.exports}var ps=hs((function(t){(t.exports={}).forEach=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n]);if(r)return r}}})),ds=hs((function(t){var e=t.exports={};e.isIE=function(t){return(-1!==(e=navigator.userAgent.toLowerCase()).indexOf("msie")||-1!==e.indexOf("trident")||-1!==e.indexOf(" edge/"))&&(!t||t===function(){var t=3,e=document.createElement("div"),n=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(n[0]);return t>4?t:undefined}());var e},e.isLegacyOpera=function(){return!!window.opera}})),ys=hs((function(t){(t.exports={}).getOption=function(t,e,n){var r=t[e];if(null==r&&void 0!==n)return n;return r}})),ms=function(t){var e=(t=t||{}).reporter,n=ys.getOption(t,"async",!0),r=ys.getOption(t,"auto",!0);r&&!n&&(e&&e.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),n=!0);var i,o=gs(),s=!1;function a(){for(s=!0;o.size();){var t=o;o=gs(),t.process()}s=!1}function u(){var t;t=a,i=setTimeout(t,0)}return{add:function(t,e){!s&&r&&n&&0===o.size()&&u(),o.add(t,e)},force:function(t){s||(void 0===t&&(t=n),i&&(clearTimeout(i),i=null),t?u():a())}}};function gs(){var t={},e=0,n=0,r=0;return{add:function(i,o){o||(o=i,i=0),i>n?n=i:i<r&&(r=i),t[i]||(t[i]=[]),t[i].push(o),e++},process:function(){for(var e=r;e<=n;e++)for(var i=t[e],o=0;o<i.length;o++){(0,i[o])()}},size:function(){return e}}}function vs(t){return t._erd}var bs={initState:function(t){return t._erd={},vs(t)},getState:vs,cleanState:function(t){delete t._erd}},ws=ps.forEach,$s=function(t){var e=(t=t||{}).reporter,n=t.batchProcessor,r=t.stateHandler.getState;t.stateHandler.hasState;var i=t.idHandler;if(!n)throw new Error("Missing required dependency: batchProcessor");if(!e)throw new Error("Missing required dependency: reporter.");var o=function(){var t=500,e=500,n=document.createElement("div");n.style.cssText=u(["position: absolute","width: 1000px","height: 1000px","visibility: hidden","margin: 0","padding: 0"]);var r=document.createElement("div");r.style.cssText=u(["position: absolute","width: 500px","height: 500px","overflow: scroll","visibility: none","top: -1500px","left: -1500px","visibility: hidden","margin: 0","padding: 0"]),r.appendChild(n),document.body.insertBefore(r,document.body.firstChild);var i=t-r.clientWidth,o=e-r.clientHeight;return document.body.removeChild(r),{width:i,height:o}}(),s="erd_scroll_detection_container";function a(t){!function(t,e,n){function r(n,r){r=r||function(e){t.head.appendChild(e)};var i=t.createElement("style");return i.innerHTML=n,i.id=e,r(i),i}if(!t.getElementById(e)){var i=n+"_animation",o=n+"_animation_active",s="/* Created by the element-resize-detector library. */\n";s+="."+n+" > div::-webkit-scrollbar { "+u(["display: none"])+" }\n\n",s+="."+o+" { "+u(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+i,"animation-name: "+i])+" }\n",s+="@-webkit-keyframes "+i+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }\n",r(s+="@keyframes "+i+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }")}}(t,"erd_scroll_detection_scrollbar_style",s)}function u(e){var n=t.important?" !important; ":"; ";return(e.join(n)+n).trim()}function c(t,n,r){if(t.addEventListener)t.addEventListener(n,r);else{if(!t.attachEvent)return e.error("[scroll] Don't know how to add event listeners.");t.attachEvent("on"+n,r)}}function l(t,n,r){if(t.removeEventListener)t.removeEventListener(n,r);else{if(!t.detachEvent)return e.error("[scroll] Don't know how to remove event listeners.");t.detachEvent("on"+n,r)}}function f(t){return r(t).container.childNodes[0].childNodes[0].childNodes[0]}function h(t){return r(t).container.childNodes[0].childNodes[0].childNodes[1]}return a(window.document),{makeDetectable:function(t,a,l){function p(){if(t.debug){var n=Array.prototype.slice.call(arguments);if(n.unshift(i.get(a),"Scroll: "),e.log.apply)e.log.apply(null,n);else for(var r=0;r<n.length;r++)e.log(n[r])}}function d(t){var e=r(t).container.childNodes[0],n=window.getComputedStyle(e);return!n.width||-1===n.width.indexOf("px")}function y(){var t=window.getComputedStyle(a),e={};return e.position=t.position,e.width=a.offsetWidth,e.height=a.offsetHeight,e.top=t.top,e.right=t.right,e.bottom=t.bottom,e.left=t.left,e.widthCSS=t.width,e.heightCSS=t.height,e}function m(){if(p("storeStyle invoked."),r(a)){var t=y();r(a).style=t}else p("Aborting because element has been uninstalled")}function g(t,e,n){r(t).lastWidth=e,r(t).lastHeight=n}function v(){return 2*o.width+1}function b(){return 2*o.height+1}function w(t){return t+10+v()}function $(t){return t+10+b()}function _(t,e,n){var r=f(t),i=h(t),o=w(e),s=$(n),a=function(t){return 2*t+v()}(e),u=function(t){return 2*t+b()}(n);r.scrollLeft=o,r.scrollTop=s,i.scrollLeft=a,i.scrollTop=u}function S(){var t=r(a).container;if(!t){(t=document.createElement("div")).className=s,t.style.cssText=u(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),r(a).container=t,function(t){t.className+=" "+s+"_animation_active"}(t),a.appendChild(t);var e=function(){r(a).onRendered&&r(a).onRendered()};c(t,"animationstart",e),r(a).onAnimationStart=e}return t}function x(){if(p("Injecting elements"),r(a)){!function(){var n=r(a).style;if("static"===n.position){a.style.setProperty("position","relative",t.important?"important":"");var i=function(t,e,n,r){var i=n[r];"auto"!==i&&"0"!==function(t){return t.replace(/[^-\d\.]/g,"")}(i)&&(t.warn("An element that is positioned static has style."+r+"="+i+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+r+" will be set to 0. Element: ",e),e.style[r]=0)};i(e,a,n,"top"),i(e,a,n,"right"),i(e,a,n,"bottom"),i(e,a,n,"left")}}();var n=r(a).container;n||(n=S());var i,l,f,h,d=o.width,y=o.height,m=u(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),g=u(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(["left: "+(i=(i=-(1+d))?i+"px":"0"),"top: "+(l=(l=-(1+y))?l+"px":"0"),"right: "+(h=(h=-d)?h+"px":"0"),"bottom: "+(f=(f=-y)?f+"px":"0")])),v=u(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),b=u(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),w=u(["position: absolute","left: 0","top: 0"]),$=u(["position: absolute","width: 200%","height: 200%"]),_=document.createElement("div"),x=document.createElement("div"),E=document.createElement("div"),P=document.createElement("div"),k=document.createElement("div"),O=document.createElement("div");_.dir="ltr",_.style.cssText=m,_.className=s,x.className=s,x.style.cssText=g,E.style.cssText=v,P.style.cssText=w,k.style.cssText=b,O.style.cssText=$,E.appendChild(P),k.appendChild(O),x.appendChild(E),x.appendChild(k),_.appendChild(x),n.appendChild(_),c(E,"scroll",I),c(k,"scroll",T),r(a).onExpandScroll=I,r(a).onShrinkScroll=T}else p("Aborting because element has been uninstalled");function I(){r(a).onExpand&&r(a).onExpand()}function T(){r(a).onShrink&&r(a).onShrink()}}function E(){function o(e,n,r){var i=function(t){return f(t).childNodes[0]}(e),o=w(n),s=$(r);i.style.setProperty("width",o+"px",t.important?"important":""),i.style.setProperty("height",s+"px",t.important?"important":"")}function s(s){var c=a.offsetWidth,l=a.offsetHeight,f=c!==r(a).lastWidth||l!==r(a).lastHeight;p("Storing current size",c,l),g(a,c,l),n.add(0,(function(){if(f)if(r(a))if(u()){if(t.debug){var n=a.offsetWidth,s=a.offsetHeight;n===c&&s===l||e.warn(i.get(a),"Scroll: Size changed before updating detector elements.")}o(a,c,l)}else p("Aborting because element container has not been initialized");else p("Aborting because element has been uninstalled")})),n.add(1,(function(){r(a)?u()?_(a,c,l):p("Aborting because element container has not been initialized"):p("Aborting because element has been uninstalled")})),f&&s&&n.add(2,(function(){r(a)?u()?s():p("Aborting because element container has not been initialized"):p("Aborting because element has been uninstalled")}))}function u(){return!!r(a).container}function c(){p("notifyListenersIfNeeded invoked");var t=r(a);return void 0===r(a).lastNotifiedWidth&&t.lastWidth===t.startSize.width&&t.lastHeight===t.startSize.height?p("Not notifying: Size is the same as the start size, and there has been no notification yet."):t.lastWidth===t.lastNotifiedWidth&&t.lastHeight===t.lastNotifiedHeight?p("Not notifying: Size already notified"):(p("Current size not notified, notifying..."),t.lastNotifiedWidth=t.lastWidth,t.lastNotifiedHeight=t.lastHeight,void ws(r(a).listeners,(function(t){t(a)})))}function l(){p("Scroll detected."),d(a)?p("Scroll event fired while unrendered. Ignoring..."):s(c)}if(p("registerListenersAndPositionElements invoked."),r(a)){r(a).onRendered=function(){if(p("startanimation triggered."),d(a))p("Ignoring since element is still unrendered...");else{p("Element rendered.");var t=f(a),e=h(a);0!==t.scrollLeft&&0!==t.scrollTop&&0!==e.scrollLeft&&0!==e.scrollTop||(p("Scrollbars out of sync. Updating detector elements..."),s(c))}},r(a).onExpand=l,r(a).onShrink=l;var y=r(a).style;o(a,y.width,y.height)}else p("Aborting because element has been uninstalled")}function P(){if(p("finalizeDomMutation invoked."),r(a)){var t=r(a).style;g(a,t.width,t.height),_(a,t.width,t.height)}else p("Aborting because element has been uninstalled")}function k(){l(a)}function O(){var t;p("Installing..."),r(a).listeners=[],t=y(),r(a).startSize={width:t.width,height:t.height},p("Element start size",r(a).startSize),n.add(0,m),n.add(1,x),n.add(2,E),n.add(3,P),n.add(4,k)}l||(l=a,a=t,t=null),t=t||{},p("Making detectable..."),!function(t){return!function(t){var e=t.getRootNode&&t.getRootNode().contains(t);return t===t.ownerDocument.body||t.ownerDocument.body.contains(t)||e}(t)||null===window.getComputedStyle(t)}(a)?O():(p("Element is detached"),S(),p("Waiting until element is attached..."),r(a).onRendered=function(){p("Element is now attached"),O()})},addListener:function(t,e){if(!r(t).listeners.push)throw new Error("Cannot add listener to an element that is not detectable.");r(t).listeners.push(e)},uninstall:function(t){var e=r(t);e&&(e.onExpandScroll&&l(f(t),"scroll",e.onExpandScroll),e.onShrinkScroll&&l(h(t),"scroll",e.onShrinkScroll),e.onAnimationStart&&l(e.container,"animationstart",e.onAnimationStart),e.container&&t.removeChild(e.container))},initDocument:a}},_s=ps.forEach;function Ss(t){return Array.isArray(t)||void 0!==t.length}function xs(t){if(Array.isArray(t))return t;var e=[];return _s(t,(function(t){e.push(t)})),e}function Es(t){return t&&1===t.nodeType}function Ps(t,e,n){var r=t[e];return null==r&&void 0!==n?n:r}var ks=function(t){var e,n;if((t=t||{}).idHandler)e={get:function(e){return t.idHandler.get(e,!0)},set:t.idHandler.set};else{var r=function(t){var e=t.idGenerator,n=t.stateHandler.getState;return{get:function(t){var e=n(t);return e&&void 0!==e.id?e.id:null},set:function(t){var r=n(t);if(!r)throw new Error("setId required the element to have a resize detection state.");var i=e.generate();return r.id=i,i}}}({idGenerator:(n=1,{generate:function(){return n++}}),stateHandler:bs});e=r}var i=t.reporter;i||(i=function(t){function e(){}var n={log:e,warn:e,error:e};if(!t&&window.console){var r=function(t,e){t[e]=function(){var t=console[e];if(t.apply)t.apply(console,arguments);else for(var n=0;n<arguments.length;n++)t(arguments[n])}};r(n,"log"),r(n,"warn"),r(n,"error")}return n}(!1===i));var o=Ps(t,"batchProcessor",ms({reporter:i})),s={};s.callOnAdd=!!Ps(t,"callOnAdd",!0),s.debug=!!Ps(t,"debug",!1);var a,u=function(t){var e={};function n(n){var r=t.get(n);return void 0===r?[]:e[r]||[]}return{get:n,add:function(n,r){var i=t.get(n);e[i]||(e[i]=[]),e[i].push(r)},removeListener:function(t,e){for(var r=n(t),i=0,o=r.length;i<o;++i)if(r[i]===e){r.splice(i,1);break}},removeAllListeners:function(t){var e=n(t);e&&(e.length=0)}}}(e),c=function(t){var e=t.stateHandler.getState;return{isDetectable:function(t){var n=e(t);return n&&!!n.isDetectable},markAsDetectable:function(t){e(t).isDetectable=!0},isBusy:function(t){return!!e(t).busy},markBusy:function(t,n){e(t).busy=!!n}}}({stateHandler:bs}),l=Ps(t,"strategy","object"),f=Ps(t,"important",!1),h={reporter:i,batchProcessor:o,stateHandler:bs,idHandler:e,important:f};if("scroll"===l&&(ds.isLegacyOpera()?(i.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),l="object"):ds.isIE(9)&&(i.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),l="object")),"scroll"===l)a=$s(h);else{if("object"!==l)throw new Error("Invalid strategy name: "+l);a=function(t){var e=(t=t||{}).reporter,n=t.batchProcessor,r=t.stateHandler.getState;if(!e)throw new Error("Missing required dependency: reporter.");function i(e){var n=t.important?" !important; ":"; ";return(e.join(n)+n).trim()}function o(t){return r(t).object}return{makeDetectable:function(t,o,s){s||(s=o,o=t,t=null),(t=t||{}).debug,ds.isIE(8)?s(o):function(o,s){var a=i(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),u=!1,c=window.getComputedStyle(o),l=o.offsetWidth,f=o.offsetHeight;function h(){function n(){if("static"===c.position){o.style.setProperty("position","relative",t.important?"important":"");var n=function(e,n,r,i){var o=r[i];"auto"!==o&&"0"!==function(t){return t.replace(/[^-\d\.]/g,"")}(o)&&(e.warn("An element that is positioned static has style."+i+"="+o+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+i+" will be set to 0. Element: ",n),n.style.setProperty(i,"0",t.important?"important":""))};n(e,o,c,"top"),n(e,o,c,"right"),n(e,o,c,"bottom"),n(e,o,c,"left")}}""!==c.position&&(n(),u=!0);var i=document.createElement("object");i.style.cssText=a,i.tabIndex=-1,i.type="text/html",i.setAttribute("aria-hidden","true"),i.onload=function(){u||n(),function t(e,n){if(!e.contentDocument){var i=r(e);return i.checkForObjectDocumentTimeoutId&&window.clearTimeout(i.checkForObjectDocumentTimeoutId),void(i.checkForObjectDocumentTimeoutId=setTimeout((function(){i.checkForObjectDocumentTimeoutId=0,t(e,n)}),100))}n(e.contentDocument)}(this,(function(t){s(o)}))},ds.isIE()||(i.data="about:blank"),r(o)&&(o.appendChild(i),r(o).object=i,ds.isIE()&&(i.data="about:blank"))}r(o).startSize={width:l,height:f},n?n.add(h):h()}(o,s)},addListener:function(t,e){function n(){e(t)}if(ds.isIE(8))r(t).object={proxy:n},t.attachEvent("onresize",n);else{var i=o(t);if(!i)throw new Error("Element is not detectable by this strategy.");i.contentDocument.defaultView.addEventListener("resize",n)}},uninstall:function(t){if(r(t)){var e=o(t);e&&(ds.isIE(8)?t.detachEvent("onresize",e.proxy):t.removeChild(e),r(t).checkForObjectDocumentTimeoutId&&window.clearTimeout(r(t).checkForObjectDocumentTimeoutId),delete r(t).object)}}}}(h)}var p={};return{listenTo:function(t,n,r){function o(t){var e=u.get(t);_s(e,(function(e){e(t)}))}function l(t,e,n){u.add(e,n),t&&n(e)}if(r||(r=n,n=t,t={}),!n)throw new Error("At least one element required.");if(!r)throw new Error("Listener required.");if(Es(n))n=[n];else{if(!Ss(n))return i.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");n=xs(n)}var h=0,d=Ps(t,"callOnAdd",s.callOnAdd),y=Ps(t,"onReady",(function(){})),m=Ps(t,"debug",s.debug);_s(n,(function(t){bs.getState(t)||(bs.initState(t),e.set(t));var s=e.get(t);if(m&&i.log("Attaching listener to element",s,t),!c.isDetectable(t))return m&&i.log(s,"Not detectable."),c.isBusy(t)?(m&&i.log(s,"System busy making it detectable"),l(d,t,r),p[s]=p[s]||[],void p[s].push((function(){++h===n.length&&y()}))):(m&&i.log(s,"Making detectable..."),c.markBusy(t,!0),a.makeDetectable({debug:m,important:f},t,(function(t){if(m&&i.log(s,"onElementDetectable"),bs.getState(t)){c.markAsDetectable(t),c.markBusy(t,!1),a.addListener(t,o),l(d,t,r);var e=bs.getState(t);if(e&&e.startSize){var u=t.offsetWidth,f=t.offsetHeight;e.startSize.width===u&&e.startSize.height===f||o(t)}p[s]&&_s(p[s],(function(t){t()}))}else m&&i.log(s,"Element uninstalled before being detectable.");delete p[s],++h===n.length&&y()})));m&&i.log(s,"Already detecable, adding listener."),l(d,t,r),h++})),h===n.length&&y()},removeListener:u.removeListener,removeAllListeners:u.removeAllListeners,uninstall:function(t){if(!t)return i.error("At least one element is required.");if(Es(t))t=[t];else{if(!Ss(t))return i.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");t=xs(t)}_s(t,(function(t){u.removeAllListeners(t),a.uninstall(t),bs.cleanState(t)}))},initDocument:function(t){a.initDocument&&a.initDocument(t)}}}({strategy:"scroll"});function Os(t,e){ks.listenTo(t,e);var n=e;return{update:function(e){ks.removeListener(t,n),ks.listenTo(t,e),n=e},destroy:function(){ks.removeListener(t,n)}}}function Is(t){let e,n;return e=new Si({}),{c(){W(e.$$.fragment)},m(t,r){K(e,t,r),n=!0},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Ts(e){let n,o,s,l,h,d,g,v,w,$,_,S,x,E,P,k,O,I,T,A,N,C,D,j,F,H,R,U,L;s=new st({}),g=new Do({});let Q=e[3]&&Is();return _=new Ni({}),x=new Ui({}),P=new zi({}),O=new Ji({}),A=new to({}),C=new ro({}),j=new co({}),H=new Io({props:{filling:e[0]}}),H.$on("mousekeydown",e[4]),H.$on("mousekeyup",e[5]),{c(){n=f("div"),o=f("div"),W(s.$$.fragment),l=p(),h=f("div"),d=f("div"),W(g.$$.fragment),v=p(),Q&&Q.c(),w=p(),$=f("div"),W(_.$$.fragment),S=p(),W(x.$$.fragment),E=p(),W(P.$$.fragment),k=p(),W(O.$$.fragment),I=p(),T=f("div"),W(A.$$.fragment),N=p(),W(C.$$.fragment),D=p(),W(j.$$.fragment),F=p(),W(H.$$.fragment),m(T,"class","last-row"),m($,"class","state"),m(d,"class","panel svelte-17431so"),m(h,"class","screen svelte-17431so"),m(o,"class","react svelte-17431so"),b(o,"drop",e[2]),m(n,"id","host"),m(n,"class","svelte-17431so")},m(r,c){var f;u(r,n,c),a(n,o),K(s,o,null),a(o,l),a(o,h),a(h,d),K(g,d,null),a(d,v),Q&&Q.m(d,null),a(d,w),a(d,$),K(_,$,null),a($,S),K(x,$,null),a($,E),K(P,$,null),a($,k),K(O,$,null),a($,I),a($,T),K(A,T,null),a(T,N),K(C,T,null),a(T,D),K(j,T,null),a(n,F),K(H,n,null),e[10](n),R=!0,U||(L=[y(window,"keydown",e[6]),y(window,"keyup",e[7]),y(window,"resize",e[8]),y(window,"error",e[9]),(f=Os.call(null,n,e[8]),f&&i(f.destroy)?f.destroy:t)],U=!0)},p(t,e){t[3]?Q?8&e[0]&&B(Q,1):(Q=Is(),Q.c(),B(Q,1),Q.m(d,w)):Q&&(V(),z(Q,1,1,(()=>{Q=null})),M()),4&e[0]&&b(o,"drop",t[2]);const n={};1&e[0]&&(n.filling=t[0]),H.$set(n)},i(t){R||(B(s.$$.fragment,t),B(g.$$.fragment,t),B(Q),B(_.$$.fragment,t),B(x.$$.fragment,t),B(P.$$.fragment,t),B(O.$$.fragment,t),B(A.$$.fragment,t),B(C.$$.fragment,t),B(j.$$.fragment,t),B(H.$$.fragment,t),R=!0)},o(t){z(s.$$.fragment,t),z(g.$$.fragment,t),z(Q),z(_.$$.fragment,t),z(x.$$.fragment,t),z(P.$$.fragment,t),z(O.$$.fragment,t),z(A.$$.fragment,t),z(C.$$.fragment,t),z(j.$$.fragment,t),z(H.$$.fragment,t),R=!1},d(t){t&&c(n),q(s),q(g),Q&&Q.d(),q(_),q(x),q(P),q(O),q(A),q(C),q(j),q(H),e[10](null),U=!1,r(L)}}}function As(t,e,n){let r,i,o,s,a,u;function c(){const t=document.documentElement.clientWidth,e=document.documentElement.clientHeight;let o=1;if(e/t<1.5)o=e/960;else{o=t/640,n(0,r=(e-960*o)/o/3);!function(t,e,r){n(1,i.style.paddingTop=`${t}px`,i),n(1,i.style.paddingBottom=`${e}px`,i),n(1,i.style.marginTop=`${r}px`,i)}(Math.floor(r)+42,Math.floor(r),Math.floor(-480-1.5*r))}n(1,i.style.transform=`scale(${o-.02})`,i)}function l(){Uo(),Mo({left:!0}),I()?zo()||(is(),us(Wo().store()),us(Wo().moveLeft()),ts()&&us(Wo().revert()),rs()):function(){const{initSpeed:t}=bi(),e=t-1<1?6:t-1;ai.update({initSpeed:e})}()}function f(){Mo({left:!1})}function h(){Uo(),Mo({right:!0}),I()?zo()||(is(),us(Wo().store()),us(Wo().moveRight()),es()&&us(Wo().revert()),rs()):function(){const{initSpeed:t}=bi(),e=t+1>6?1:t+1;ai.update({initSpeed:e})}()}function p(){Mo({right:!1})}function d(){Lo(0,2.2471,.0807),Mo({up:!0}),I()?function(){if(!zo()){for(is(),us(Wo().store()),us(Wo().rotate());es();)if(us(Wo().moveLeft()),ts()){us(Wo().revert());break}rs()}}():function(){const{initLine:t}=bi(),e=t+1>10?1:t+1;ai.update({initLine:e})}()}function y(){Mo({up:!1})}function m(){Uo(),Mo({down:!0}),I()?Xo():function(){const{initLine:t}=bi(),e=t-1<1?10:t-1;ai.update({initLine:e})}()}function g(){Mo({down:!1})}function v(){if(Mo({drop:!0}),I())return Lo(0,1.2558,.3546),void function(){if(!zo()){for(;!Zo();)is(),us(Wo().store()),us(Wo().moveDown());us(Wo().revert()),rs()}}();Lo(0,3.7202,3.6224),function(){Wo()||(us(Ko()),as());const{initLine:t,initSpeed:e}=bi();ai.update({points:0,gameState:pn.Started,matrix:bn.getStartBoard(t),speed:e}),fs(),Qo(bn.getSpeedDelay(e)),ls(!1)}()}function b(){Mo({drop:!1})}function w(){Uo(),function(){const t=bi().sound;ai.update({sound:!t})}(),Mo({sound:!0})}function $(){Mo({sound:!1})}function _(){Uo(),Mo({pause:!0}),bi().gameState!==pn.Started?Yo():Go()}function S(){Mo({pause:!1})}function P(){Uo(),Mo({reset:!0}),Go(),setTimeout((()=>{confirm("Are you sure you want to reset?")?Jo():Yo(),k()}))}function k(){Mo({reset:!1})}function I(){return!!wi()}return x((()=>{o=go.subscribe((t=>n(2,a=t))),s=vi.subscribe((t=>n(3,u=t)))})),E((()=>{o.unsubscribe(),s.unsubscribe()})),[r,i,a,u,function(t){switch(`keyDown${t.detail.key}`){case"keyDownUp":d();break;case"keyDownDown":m();break;case"keyDownLeft":l();break;case"keyDownRight":h();break;case"keyDownSound":w();break;case"keyDownReset":P();break;case"keyDownPause":_();break;case"keyDownSpace":v()}},function(t){switch(`keyUp${t.detail.key}`){case"keyUpUp":y();break;case"keyUpDown":g();break;case"keyUpLeft":f();break;case"keyUpRight":p();break;case"keyUpSound":$();break;case"keyUpReset":k();break;case"keyUpPause":S();break;case"keyUpSpace":b()}},function(t){switch(t.keyCode){case 38:d();break;case 40:m();break;case 37:l();break;case 39:h();break;case 83:w();break;case 82:P();break;case 80:_();break;case 32:v()}},function(t){switch(t.keyCode){case 38:y();break;case 40:g();break;case 37:f();break;case 39:p();break;case 83:$();break;case 82:k();break;case 80:S();break;case 32:b()}},function(t){c()},function(t){Jo()},function(t){O[t?"unshift":"push"]((()=>{i=t,n(1,i)}))}]}class Ns extends G{constructor(t){super(),Y(this,t,As,Ts,o,{},null,[-1,-1])}}function Cs(e){let n,r,i;return r=new Ns({}),{c(){n=f("main"),W(r.$$.fragment)},m(t,e){u(t,n,e),K(r,n,null),i=!0},p:t,i(t){i||(B(r.$$.fragment,t),i=!0)},o(t){z(r.$$.fragment,t),i=!1},d(t){t&&c(n),q(r)}}}!function(t,e){if(void 0===e&&(e={}),!yr&&window.__REDUX_DEVTOOLS_EXTENSION__){_r.length&&_r.forEach((function(t){t.unsubscribe?t.unsubscribe():t&&t()})),t&&t.run||((t=t||{}).run=function(t){return t()},e=t);var n=Object.assign({},{name:"Akita",shallow:!0,storesWhitelist:[]},e),r=n.storesWhitelist,i=window.__REDUX_DEVTOOLS_EXTENSION__.connect(n),o={},s=function(t){return!r.length||r.indexOf(t)>-1};_r.push(hr.subscribe((function(t){var e;!1!==s(t)&&(o=Ln(Ln({},o),((e={})[t]=gr[t]._value(),e)),i.send({type:"["+br(t)+"] - @@INIT"},o))}))),_r.push(fr.subscribe((function(t){!1!==s(t)&&(delete o[t],i.send({type:"["+t+"] - Delete Store"},o))}))),_r.push(pr.subscribe((function(t){var n,r=t.storeName,a=t.action;if(!1!==s(r)){var u=a.type,c=a.entityIds,l=a.skip,f=Vn(a,["type","entityIds","skip"]).payload;if(l)!function(t){void 0===t&&(t=!0),qn.skip=t}(!1);else{var h=gr[r];if(h){if(!1===e.shallow&&o[r])if(JSON.stringify(h._value())===JSON.stringify(o[r]))return;o=Ln(Ln({},o),((n={})[r]=h._value(),n));var p=br(r),d=lr(c)?"["+p+"] - "+u+" (ids: "+c+")":"["+p+"] - "+u;if(e.logTrace&&(console.group(d),console.trace(),console.groupEnd()),e.sortAlphabetically){var y=Object.keys(o).sort().reduce((function(t,e){return t[e]=o[e],t}),{});i.send(Ln({type:d},f),y)}else i.send(Ln({type:d},f),o)}}}}))),_r.push(i.subscribe((function(e){if("DISPATCH"===e.type){if("COMMIT"===e.payload.type)return void i.init(o);if(e.state)for(var n=JSON.parse(e.state),r=function(e,r){var i=r[e];gr[i]&&t.run((function(){gr[i]._setState((function(){return n[i]}),!1)}))},s=0,a=Object.keys(n);s<a.length;s++)r(s,a)}})))}}(),function(t){var e={key:"AkitaStores",enableInNonBrowser:!1,storage:mr()?localStorage:t.storage,deserialize:JSON.parse,serialize:JSON.stringify,include:[],select:[],persistOnDestroy:!1,preStorageUpdate:function(t,e){return e},preStoreUpdate:function(t,e){return e},skipStorageUpdate:Qr,preStorageUpdateOperator:function(){return function(t){return t}}},n=Object.assign({},e,t),r=n.storage,i=n.enableInNonBrowser,o=n.deserialize,s=n.serialize,a=n.include,u=n.select,c=n.key,l=n.preStorageUpdate,f=n.persistOnDestroy,h=n.preStorageUpdateOperator,p=n.preStoreUpdate,d=n.skipStorageUpdate;if((!yr||i)&&r){var y,m,g=a.length>0,v=u.length>0;g&&(y=a.reduce((function(t,e){sr(e)?t.fns.push(e):t[e.split(".")[0]]=e;return t}),{fns:[]})),v&&(m=u.reduce((function(t,e){return t[e.storeName]=e,t}),{}));var b={},w={},$=[],_=[],S=mr()&&r===localStorage||function(){try{return"undefined"!=typeof sessionStorage}catch(t){return!1}}()&&r===sessionStorage;return Yr(r.getItem(c)).subscribe((function(t){var e=ar(t)?t:o(t||"{}");function n(t){e.$cache=Ln(Ln({},e.$cache||{}),t),e=Object.assign({},e,w),_.push(r.setItem(c,S?s(e):e)),x(_.shift())}function i(t,e){b[t]=gr[t]._select((function(t){return Wr(t,e)})).pipe(en(1),ee((function(e){return v&&m[t]?m[t](e):e})),Ie((function(){return!1===d()})),h()).subscribe((function(e){w[t]=l(t,e),Promise.resolve().then((function(){var e;return n(((e={})[t]=gr[t]._cache().getValue(),e))}))}))}function a(t,n,r){if(t in e){Gn("@PersistState"),n._setState((function(n){return Kr(n,r,p(t,e[t],n))}));var i=!!e.$cache&&e.$cache[t];gr[t].setHasCache(i,{restartTTL:!0})}}$.push(fr.subscribe((function(t){var e;b[t]&&(!1===f&&n(((e={})[t]=!1,e)),b[t].unsubscribe(),delete b[t])}))),$.push(hr.subscribe((function(t){if("router"!==t){var e=gr[t];if(g){var n=y[t];if(!n){if(!y.fns.some((function(e){return e(t)})))return;n=t}a(t,e,n),i(t,n)}else a(t,e,t),i(t,t)}}))),qr.next()})),{destroy:function(){$.forEach((function(t){return t.unsubscribe()}));for(var t=0,e=Object.keys(b);t<e.length;t++){var n=e[t];b[n].unsubscribe()}b={}},clear:function(){r.clear()},clearStore:function(t){rr(t)?Yr(r.setItem(c,"{}")).subscribe():Yr(r.getItem(c)).subscribe((function(e){var n=o(e||"{}");n[t]&&(delete n[t],Yr(r.setItem(c,s(n))).subscribe())}))}}}function x(t){Yr(t).subscribe((function(){var t=_.shift();t&&x(t)}))}}();return new class extends G{constructor(t){super(),Y(this,t,null,Cs,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
